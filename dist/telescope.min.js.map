{"version":3,"file":"telescope.min.js","sources":["../node_modules/tslib/tslib.es6.js","../src/constant/index.ts","../src/core/config.ts","../src/91jkys.ts","../node_modules/ramda/src/internal/_isPlaceholder.js","../node_modules/ramda/src/internal/_curry1.js","../node_modules/ramda/src/internal/_curry2.js","../node_modules/ramda/src/internal/_arrayFromIterator.js","../node_modules/ramda/src/internal/_includesWith.js","../node_modules/ramda/src/internal/_functionName.js","../node_modules/ramda/src/internal/_has.js","../node_modules/ramda/src/internal/_objectIs.js","../node_modules/ramda/src/internal/_isArguments.js","../node_modules/ramda/src/keys.js","../node_modules/ramda/src/type.js","../node_modules/ramda/src/internal/_equals.js","../node_modules/ramda/src/equals.js","../src/utils/util.ts","../src/core/pageInfo.ts","../src/core/libInfo.ts","../src/core/user.ts","../node_modules/ramda/src/pick.js","../src/core/send.ts","../src/utils/http.ts","../src/core/clientInfo.ts","../src/core/netInfo.ts","../src/core/pageTimeTracker.ts","../src/core/viewTracker.ts","../node_modules/vissense/dist/vissense.js","../src/core/actionTracker.ts","../node_modules/ramda/src/internal/_isInteger.js","../node_modules/ramda/src/internal/_isString.js","../node_modules/ramda/src/nth.js","../node_modules/ramda/src/paths.js","../node_modules/ramda/src/path.js","../node_modules/ramda/src/prop.js","../node_modules/ramda/src/internal/_curry3.js","../node_modules/ramda/src/always.js","../node_modules/ramda/src/over.js","../node_modules/ramda/src/set.js","../node_modules/ramda/src/internal/_arity.js","../node_modules/ramda/src/internal/_curryN.js","../node_modules/ramda/src/curryN.js","../src/decoratiors/tools.ts","../src/directives/generate.ts","../src/directives/trackView.ts","../src/directives/trackEvent.ts","../src/directives/trackPage.ts","../src/core/bindEvent.ts","../src/utils/hijackHistoryEvent.ts","../src/internal.ts","../src/index.ts","../src/decoratiors/tracker.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","//日志收集接口\nexport const SERVER_URL = `${\n  window.location.protocol === 'https:' ? 'https:' : 'http:'\n}//frontlo-collection.91jkys.com/log.gif`; //'http://test.qa.91jkys.com:9342/log.gif';\n\nexport const CUSTOM_TOKEN_KEY = 'TRACKER_IDENTIFY';\n\nexport const SEND_TYPE = {\n  SYNC: 'SYNC',\n  ASYNC: 'ASYNC',\n  UNLOAD: 'UNLOAD'\n};\n\nexport const ENVIRONMENT = {\n  PRODUCTION: 'production',\n  DEVELOPMENT: 'development'\n};\n\nexport const ACTION_TYPE = {\n  EVENT: 'EVENT',\n  PAGE: 'PAGE',\n  VIEW: 'VIEW',\n  DURATION: 'DURATION'\n};\n\nexport const DATA_KEY = {\n  trackId: 'trackId'\n};\n\nexport const SAFETY_KEY = [\n  'custom',\n  'actionType',\n  'eventName',\n  'pageId',\n  'domId',\n  'domClass',\n  'domHref',\n  'domName',\n  'domTag',\n  'domContent',\n  'domPath',\n  'trackId',\n  'referrerId',\n  'score',\n  'startTime',\n  'endTime',\n  'durationTime',\n  'channel',\n  'netType'\n];\n","import { CUSTOM_TOKEN_KEY, SERVER_URL } from './../constant/index';\n\nimport { SEND_TYPE } from '../constant';\n// import Base64 from '../utils/base64';\n// import { getGlobal } from 'src/utils/util';\n\nexport interface IConfig {\n  store: string;\n  trackKey: string;\n  serverUrl: string;\n  watchHistoryAndHash: boolean;\n  pageTime: boolean;\n  env: string;\n  console: boolean;\n  projectId: number;\n  version: string;\n  domain: string;\n  sendType: string;\n  delayTime: number;\n  autoTrackPage: boolean;\n  autoTrackClick: boolean;\n  autoInstall: boolean;\n  delayLink: boolean;\n  delayLinkTime: number;\n  useServerTime: boolean;\n  corssSubdomain: boolean;\n  utokenKey: string;\n}\n\n//default config\nlet config: IConfig = {\n  store: 'test',\n  trackKey: '', //日志验证\n  serverUrl: SERVER_URL,\n  pageTime: true, //是否记录页面停留时间\n  watchHistoryAndHash: true, //单页面应用监听\n  env: 'PRODUCT',\n  console: true,\n  projectId: null,\n  version: null,\n  domain: '',\n  sendType: SEND_TYPE.ASYNC, //发送日志方式 (同步发,异步延迟发,关闭浏览器前发送)\n  delayTime: 1000, //延迟发送的时间\n  autoTrackPage: false, //自动埋点页面\n  autoTrackClick: false, //自动埋点a,button,input\n  autoInstall: true, //自定开始埋点监控\n  delayLink: true, //跳转延迟\n  delayLinkTime: 200,\n  useServerTime: true, //使用服务器时间\n  corssSubdomain: false, //false 域名不同认作为两个用户\n  utokenKey: CUSTOM_TOKEN_KEY\n};\n\n//script tracker-key  config\nlet scriptDom = document.querySelector('script[track-key]');\nif (scriptDom) {\n  let trackKey = scriptDom.getAttribute('track-key') || '';\n  if (trackKey) {\n    config.trackKey = trackKey;\n  }\n}\n\nexport function getConfig() {\n  return config;\n}\n\nexport function setConfig(data: Partial<IConfig>) {\n  config = { ...config, ...data };\n}\n","import { setConfig } from './core/config';\nimport { login } from './core/user';\n\nif (/\\.(pre|qa|127|192|)\\.|localhost/) {\n  setConfig({ serverUrl: 'http://frontlo-collection.qa.91jkys.com/log.gif' });\n}\n\n// if (typeof Sailer !== 'undefined' && typeof adapt !== 'undefined') {\n//   if (adapt.isLogin()) {\n//     adapt.getUserInfo().then(({ uid }: any) => {\n//       login(uid);\n//     });\n//   }\n// }\n","function _isPlaceholder(a) {\n  return a != null && typeof a === 'object' && a['@@functional/placeholder'] === true;\n}\n\nmodule.exports = _isPlaceholder;","var _isPlaceholder =\n/*#__PURE__*/\nrequire(\"./_isPlaceholder\");\n/**\n * Optimized internal one-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\n\n\nfunction _curry1(fn) {\n  return function f1(a) {\n    if (arguments.length === 0 || _isPlaceholder(a)) {\n      return f1;\n    } else {\n      return fn.apply(this, arguments);\n    }\n  };\n}\n\nmodule.exports = _curry1;","var _curry1 =\n/*#__PURE__*/\nrequire(\"./_curry1\");\n\nvar _isPlaceholder =\n/*#__PURE__*/\nrequire(\"./_isPlaceholder\");\n/**\n * Optimized internal two-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\n\n\nfunction _curry2(fn) {\n  return function f2(a, b) {\n    switch (arguments.length) {\n      case 0:\n        return f2;\n\n      case 1:\n        return _isPlaceholder(a) ? f2 : _curry1(function (_b) {\n          return fn(a, _b);\n        });\n\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f2 : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b);\n        }) : fn(a, b);\n    }\n  };\n}\n\nmodule.exports = _curry2;","function _arrayFromIterator(iter) {\n  var list = [];\n  var next;\n\n  while (!(next = iter.next()).done) {\n    list.push(next.value);\n  }\n\n  return list;\n}\n\nmodule.exports = _arrayFromIterator;","function _includesWith(pred, x, list) {\n  var idx = 0;\n  var len = list.length;\n\n  while (idx < len) {\n    if (pred(x, list[idx])) {\n      return true;\n    }\n\n    idx += 1;\n  }\n\n  return false;\n}\n\nmodule.exports = _includesWith;","function _functionName(f) {\n  // String(x => x) evaluates to \"x => x\", so the pattern may not match.\n  var match = String(f).match(/^function (\\w*)/);\n  return match == null ? '' : match[1];\n}\n\nmodule.exports = _functionName;","function _has(prop, obj) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = _has;","// Based on https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\nfunction _objectIs(a, b) {\n  // SameValue algorithm\n  if (a === b) {\n    // Steps 1-5, 7-10\n    // Steps 6.b-6.e: +0 != -0\n    return a !== 0 || 1 / a === 1 / b;\n  } else {\n    // Step 6.a: NaN == NaN\n    return a !== a && b !== b;\n  }\n}\n\nmodule.exports = typeof Object.is === 'function' ? Object.is : _objectIs;","var _has =\n/*#__PURE__*/\nrequire(\"./_has\");\n\nvar toString = Object.prototype.toString;\n\nvar _isArguments =\n/*#__PURE__*/\nfunction () {\n  return toString.call(arguments) === '[object Arguments]' ? function _isArguments(x) {\n    return toString.call(x) === '[object Arguments]';\n  } : function _isArguments(x) {\n    return _has('callee', x);\n  };\n}();\n\nmodule.exports = _isArguments;","var _curry1 =\n/*#__PURE__*/\nrequire(\"./internal/_curry1\");\n\nvar _has =\n/*#__PURE__*/\nrequire(\"./internal/_has\");\n\nvar _isArguments =\n/*#__PURE__*/\nrequire(\"./internal/_isArguments\"); // cover IE < 9 keys issues\n\n\nvar hasEnumBug = !\n/*#__PURE__*/\n{\n  toString: null\n}.propertyIsEnumerable('toString');\nvar nonEnumerableProps = ['constructor', 'valueOf', 'isPrototypeOf', 'toString', 'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString']; // Safari bug\n\nvar hasArgsEnumBug =\n/*#__PURE__*/\nfunction () {\n  'use strict';\n\n  return arguments.propertyIsEnumerable('length');\n}();\n\nvar contains = function contains(list, item) {\n  var idx = 0;\n\n  while (idx < list.length) {\n    if (list[idx] === item) {\n      return true;\n    }\n\n    idx += 1;\n  }\n\n  return false;\n};\n/**\n * Returns a list containing the names of all the enumerable own properties of\n * the supplied object.\n * Note that the order of the output array is not guaranteed to be consistent\n * across different JS platforms.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @sig {k: v} -> [k]\n * @param {Object} obj The object to extract properties from\n * @return {Array} An array of the object's own properties.\n * @see R.keysIn, R.values\n * @example\n *\n *      R.keys({a: 1, b: 2, c: 3}); //=> ['a', 'b', 'c']\n */\n\n\nvar keys = typeof Object.keys === 'function' && !hasArgsEnumBug ?\n/*#__PURE__*/\n_curry1(function keys(obj) {\n  return Object(obj) !== obj ? [] : Object.keys(obj);\n}) :\n/*#__PURE__*/\n_curry1(function keys(obj) {\n  if (Object(obj) !== obj) {\n    return [];\n  }\n\n  var prop, nIdx;\n  var ks = [];\n\n  var checkArgsLength = hasArgsEnumBug && _isArguments(obj);\n\n  for (prop in obj) {\n    if (_has(prop, obj) && (!checkArgsLength || prop !== 'length')) {\n      ks[ks.length] = prop;\n    }\n  }\n\n  if (hasEnumBug) {\n    nIdx = nonEnumerableProps.length - 1;\n\n    while (nIdx >= 0) {\n      prop = nonEnumerableProps[nIdx];\n\n      if (_has(prop, obj) && !contains(ks, prop)) {\n        ks[ks.length] = prop;\n      }\n\n      nIdx -= 1;\n    }\n  }\n\n  return ks;\n});\nmodule.exports = keys;","var _curry1 =\n/*#__PURE__*/\nrequire(\"./internal/_curry1\");\n/**\n * Gives a single-word string description of the (native) type of a value,\n * returning such answers as 'Object', 'Number', 'Array', or 'Null'. Does not\n * attempt to distinguish user Object types any further, reporting them all as\n * 'Object'.\n *\n * @func\n * @memberOf R\n * @since v0.8.0\n * @category Type\n * @sig (* -> {*}) -> String\n * @param {*} val The value to test\n * @return {String}\n * @example\n *\n *      R.type({}); //=> \"Object\"\n *      R.type(1); //=> \"Number\"\n *      R.type(false); //=> \"Boolean\"\n *      R.type('s'); //=> \"String\"\n *      R.type(null); //=> \"Null\"\n *      R.type([]); //=> \"Array\"\n *      R.type(/[A-z]/); //=> \"RegExp\"\n *      R.type(() => {}); //=> \"Function\"\n *      R.type(undefined); //=> \"Undefined\"\n */\n\n\nvar type =\n/*#__PURE__*/\n_curry1(function type(val) {\n  return val === null ? 'Null' : val === undefined ? 'Undefined' : Object.prototype.toString.call(val).slice(8, -1);\n});\n\nmodule.exports = type;","var _arrayFromIterator =\n/*#__PURE__*/\nrequire(\"./_arrayFromIterator\");\n\nvar _includesWith =\n/*#__PURE__*/\nrequire(\"./_includesWith\");\n\nvar _functionName =\n/*#__PURE__*/\nrequire(\"./_functionName\");\n\nvar _has =\n/*#__PURE__*/\nrequire(\"./_has\");\n\nvar _objectIs =\n/*#__PURE__*/\nrequire(\"./_objectIs\");\n\nvar keys =\n/*#__PURE__*/\nrequire(\"../keys\");\n\nvar type =\n/*#__PURE__*/\nrequire(\"../type\");\n/**\n * private _uniqContentEquals function.\n * That function is checking equality of 2 iterator contents with 2 assumptions\n * - iterators lengths are the same\n * - iterators values are unique\n *\n * false-positive result will be returned for comparision of, e.g.\n * - [1,2,3] and [1,2,3,4]\n * - [1,1,1] and [1,2,3]\n * */\n\n\nfunction _uniqContentEquals(aIterator, bIterator, stackA, stackB) {\n  var a = _arrayFromIterator(aIterator);\n\n  var b = _arrayFromIterator(bIterator);\n\n  function eq(_a, _b) {\n    return _equals(_a, _b, stackA.slice(), stackB.slice());\n  } // if *a* array contains any element that is not included in *b*\n\n\n  return !_includesWith(function (b, aItem) {\n    return !_includesWith(eq, aItem, b);\n  }, b, a);\n}\n\nfunction _equals(a, b, stackA, stackB) {\n  if (_objectIs(a, b)) {\n    return true;\n  }\n\n  var typeA = type(a);\n\n  if (typeA !== type(b)) {\n    return false;\n  }\n\n  if (a == null || b == null) {\n    return false;\n  }\n\n  if (typeof a['fantasy-land/equals'] === 'function' || typeof b['fantasy-land/equals'] === 'function') {\n    return typeof a['fantasy-land/equals'] === 'function' && a['fantasy-land/equals'](b) && typeof b['fantasy-land/equals'] === 'function' && b['fantasy-land/equals'](a);\n  }\n\n  if (typeof a.equals === 'function' || typeof b.equals === 'function') {\n    return typeof a.equals === 'function' && a.equals(b) && typeof b.equals === 'function' && b.equals(a);\n  }\n\n  switch (typeA) {\n    case 'Arguments':\n    case 'Array':\n    case 'Object':\n      if (typeof a.constructor === 'function' && _functionName(a.constructor) === 'Promise') {\n        return a === b;\n      }\n\n      break;\n\n    case 'Boolean':\n    case 'Number':\n    case 'String':\n      if (!(typeof a === typeof b && _objectIs(a.valueOf(), b.valueOf()))) {\n        return false;\n      }\n\n      break;\n\n    case 'Date':\n      if (!_objectIs(a.valueOf(), b.valueOf())) {\n        return false;\n      }\n\n      break;\n\n    case 'Error':\n      return a.name === b.name && a.message === b.message;\n\n    case 'RegExp':\n      if (!(a.source === b.source && a.global === b.global && a.ignoreCase === b.ignoreCase && a.multiline === b.multiline && a.sticky === b.sticky && a.unicode === b.unicode)) {\n        return false;\n      }\n\n      break;\n  }\n\n  var idx = stackA.length - 1;\n\n  while (idx >= 0) {\n    if (stackA[idx] === a) {\n      return stackB[idx] === b;\n    }\n\n    idx -= 1;\n  }\n\n  switch (typeA) {\n    case 'Map':\n      if (a.size !== b.size) {\n        return false;\n      }\n\n      return _uniqContentEquals(a.entries(), b.entries(), stackA.concat([a]), stackB.concat([b]));\n\n    case 'Set':\n      if (a.size !== b.size) {\n        return false;\n      }\n\n      return _uniqContentEquals(a.values(), b.values(), stackA.concat([a]), stackB.concat([b]));\n\n    case 'Arguments':\n    case 'Array':\n    case 'Object':\n    case 'Boolean':\n    case 'Number':\n    case 'String':\n    case 'Date':\n    case 'Error':\n    case 'RegExp':\n    case 'Int8Array':\n    case 'Uint8Array':\n    case 'Uint8ClampedArray':\n    case 'Int16Array':\n    case 'Uint16Array':\n    case 'Int32Array':\n    case 'Uint32Array':\n    case 'Float32Array':\n    case 'Float64Array':\n    case 'ArrayBuffer':\n      break;\n\n    default:\n      // Values of other types are only equal if identical.\n      return false;\n  }\n\n  var keysA = keys(a);\n\n  if (keysA.length !== keys(b).length) {\n    return false;\n  }\n\n  var extendedStackA = stackA.concat([a]);\n  var extendedStackB = stackB.concat([b]);\n  idx = keysA.length - 1;\n\n  while (idx >= 0) {\n    var key = keysA[idx];\n\n    if (!(_has(key, b) && _equals(b[key], a[key], extendedStackA, extendedStackB))) {\n      return false;\n    }\n\n    idx -= 1;\n  }\n\n  return true;\n}\n\nmodule.exports = _equals;","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar _equals =\n/*#__PURE__*/\nrequire(\"./internal/_equals\");\n/**\n * Returns `true` if its arguments are equivalent, `false` otherwise. Handles\n * cyclical data structures.\n *\n * Dispatches symmetrically to the `equals` methods of both arguments, if\n * present.\n *\n * @func\n * @memberOf R\n * @since v0.15.0\n * @category Relation\n * @sig a -> b -> Boolean\n * @param {*} a\n * @param {*} b\n * @return {Boolean}\n * @example\n *\n *      R.equals(1, 1); //=> true\n *      R.equals(1, '1'); //=> false\n *      R.equals([1, 2, 3], [1, 2, 3]); //=> true\n *\n *      const a = {}; a.v = a;\n *      const b = {}; b.v = b;\n *      R.equals(a, b); //=> true\n */\n\n\nvar equals =\n/*#__PURE__*/\n_curry2(function equals(a, b) {\n  return _equals(a, b, [], []);\n});\n\nmodule.exports = equals;","import equals from 'ramda/src/equals';\n\n/**\n *判断promise\n *\n * @export\n * @param {*} f\n * @returns\n */\nexport function isThenable(f: any) {\n  return f && typeof f.then === 'function';\n}\n\n/**\n *获取url参数 兼容微信支付 window.location.search改成window.location.href\n *\n * @export\n * @param {string} variable\n * @returns\n */\nexport function getQueryVariable(variable: string) {\n  var query = window.location.href.match(/\\?(.*)$/);\n  if (!query) return null;\n  var vars = query[1].split('&');\n  for (var i = 0; i < vars.length; i++) {\n    var pair = vars[i].split('=');\n    if (pair[0] == variable) {\n      return pair[1];\n    }\n  }\n  return null;\n}\n\n/**\n *获取cookie\n *\n * @export\n * @param {string} name\n * @returns\n */\nexport function getCookie(name: string) {\n  let cookies = document.cookie.split('; ');\n  for (let i in cookies) {\n    let arr = cookies[i].split('=');\n    if (name == arr[0]) {\n      return unescape(arr[1]).replace(/&&&&/g, ';');\n    }\n  }\n  return null;\n}\n\n/**\n *设置cookie\n *\n * @export\n * @param {string} name\n * @param {string} value\n * @param {number} [expires=99999999999999]\n * @param {string} [path='/']\n * @param {string} [domain]\n */\nexport function setCookie(\n  name: string,\n  value: string,\n  expires: number = 99999999999999,\n  path: string = '/',\n  domain?: string\n) {\n  document.cookie =\n    name +\n    '=' +\n    value.replace(/;/g, '&&&&') +\n    (expires ? '; expires=' + getExpires(expires) : '') +\n    (path ? '; path=' + path : '') +\n    (domain ? '; domain=' + domain : '');\n\n  function getExpires(hours: number) {\n    let date = new Date();\n    date.setTime(date.getTime() + hours * 60 * 60 * 1000);\n    return date.toUTCString();\n  }\n}\n\n/**\n *\n *\n * @export\n * @param {*} binding\n * @returns\n */\nexport function notChanged(binding: any) {\n  if (binding.oldValue !== undefined) {\n    if (typeof binding.value === 'object') {\n      return equals(binding.value, binding.oldValue);\n    } else {\n      return binding.value === binding.oldValue;\n    }\n  } else {\n    return false;\n  }\n}\n\n/**\n * if the binding value is empty\n */\nexport function isEmpty(binding: any) {\n  return binding.value === '' || binding.value === undefined || binding.value === null;\n}\n\nexport function setFlag(key: string, value = true) {\n  _TrackerGlobalData._trackerFlag = _TrackerGlobalData._trackerFlag || {};\n  _TrackerGlobalData._trackerFlag[key] = value;\n}\n\nexport function getFlag(key: string) {\n  _TrackerGlobalData._trackerFlag = _TrackerGlobalData._trackerFlag || {};\n  return _TrackerGlobalData._trackerFlag[key] || false;\n}\n\nexport function getUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = (Math.random() * 16) | 0,\n      v = c == 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n *获取dom path\n *\n * @export\n * @param {HTMLElement} dom\n * @returns\n */\nexport function getDomPath(dom: HTMLElement) {\n  let path = [dom.id ? '#' + dom.id : dom.tagName.toLowerCase()];\n  while (dom.parentNode && (dom.parentNode as HTMLElement).tagName !== 'BODY') {\n    dom = dom.parentNode as HTMLElement;\n    path.unshift(dom.id ? '#' + dom.id : dom.tagName.toLowerCase());\n  }\n  return path.join('>');\n}\n\nexport function noop() {}\n\nexport function isString(value: any) {\n  return Object.prototype.toString.call(value) === '[object String]';\n}\n\nexport function getLocationHref() {\n  if (typeof document === 'undefined' || document.location == null) return '';\n\n  return document.location.href;\n}\n\nexport function oneOf(one: any, all: any[]) {\n  for (let i in all) {\n    if (one === all[i]) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function getGlobal() {\n  return typeof window !== 'undefined' ? window : global;\n}\n\nexport function isArray(o: any) {\n  return Object.prototype.toString.call(o) === '[object Array]';\n}\n\nexport function isObject(o: any) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n}\n","import { getQueryVariable } from 'src/utils/util';\n\nexport interface IPageInfo {\n  pageId?: string;\n  referrerId?: string;\n  referrerUrl: string;\n  url: string;\n  title: string;\n  host: string;\n  path: string;\n  hash: string;\n}\n\nlet pageInfo: IPageInfo = {\n  pageId: null,\n  referrerId: getQueryVariable('referrer-id'),\n  referrerUrl: document.referrer || '',\n  url: location.origin,\n  host: location.host,\n  path: location.pathname,\n  hash: location.hash,\n  title: document.title || ''\n};\n\nexport const setPageInfo = (info: Partial<IPageInfo>) => {\n  pageInfo = {\n    ...pageInfo,\n    ...info,\n    url: location.origin,\n    host: location.host,\n    path: location.pathname,\n    hash: location.hash,\n    title: document.title || ''\n  };\n  (window as any).aaa = pageInfo;\n};\n\nexport const getPageInfo = () => {\n  return { ...pageInfo };\n};\n","export default {\n  libVersion: '1.0.0',\n  libType: 'js'\n};\n","import { getCookie, setCookie } from '../utils/util';\nimport { getConfig } from './config';\n\nexport interface IUserInfo {\n  uid?: string | number;\n  isLogin: boolean;\n}\n\nlet userInfo: IUserInfo = {\n  uid: null,\n  isLogin: false\n};\n\nexport function setUserInfo(info: IUserInfo) {\n  userInfo = {\n    ...userInfo,\n    ...info\n  };\n}\n\nexport function getUserInfo() {\n  return userInfo;\n}\n\nexport function login(info: Partial<IUserInfo>) {\n  const config = getConfig();\n  if (info.uid) {\n    let utoken = localStorage.getItem(config.utokenKey + '__' + info.uid);\n    if (utoken) {\n      setCookie(config.utokenKey, utoken);\n    }\n  }\n  setUserInfo({ ...info, isLogin: true });\n}\n\nexport function logout(moment: boolean = false) {\n  const config = getConfig();\n  const utoken = getCookie(config.utokenKey);\n\n  if (moment) {\n    localStorage.setItem(config.utokenKey + '__' + (userInfo.uid || ''), utoken);\n    setCookie(config.utokenKey, null);\n  }\n  userInfo = { uid: null, isLogin: false };\n}\n","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n/**\n * Returns a partial copy of an object containing only the keys specified. If\n * the key does not exist, the property is ignored.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @sig [k] -> {k: v} -> {k: v}\n * @param {Array} names an array of String property names to copy onto a new object\n * @param {Object} obj The object to copy from\n * @return {Object} A new object with only properties from `names` on it.\n * @see R.omit, R.props\n * @example\n *\n *      R.pick(['a', 'd'], {a: 1, b: 2, c: 3, d: 4}); //=> {a: 1, d: 4}\n *      R.pick(['a', 'e', 'f'], {a: 1, b: 2, c: 3, d: 4}); //=> {a: 1}\n */\n\n\nvar pick =\n/*#__PURE__*/\n_curry2(function pick(names, obj) {\n  var result = {};\n  var idx = 0;\n\n  while (idx < names.length) {\n    if (names[idx] in obj) {\n      result[names[idx]] = obj[names[idx]];\n    }\n\n    idx += 1;\n  }\n\n  return result;\n});\n\nmodule.exports = pick;","import { ACTION_TYPE, SAFETY_KEY } from './../constant/index';\nimport { getPageInfo, setPageInfo, IPageInfo } from './pageInfo';\nimport http from '../utils/http';\nimport libInfo from './libInfo';\nimport getNetInfo from './netInfo';\nimport clientInfo from './clientInfo';\nimport { getConfig, IConfig } from './config';\nimport { getUUID } from '../utils/util';\nimport { getUserInfo, IUserInfo } from './user';\nimport { SEND_TYPE } from '../constant/index';\nimport { ITrackerData, ICleintInfo, ILibInfo } from '../types';\nimport { isArray, isObject } from './../utils/util';\nimport pick from 'ramda/src/pick';\n\nexport interface ILogDataDataItem extends ITrackerData, IPageInfo {\n  trackTime: number;\n  id: string;\n}\n\nexport interface ILogData extends ICleintInfo, IUserInfo, ILibInfo {\n  items: ILogDataDataItem[];\n  version: string;\n}\n\nconst allData: ILogDataDataItem[] = [];\nlet timer: any = null;\nconst uuid = getUUID();\nlet index = 0;\n\n/**\n * 同步发送\n * @param data\n */\nexport function send(data: ITrackerData) {\n  const config = getConfig();\n  const { sendType } = config;\n  if (sendType === SEND_TYPE.SYNC) {\n    sendSync(data);\n  } else if (sendType === SEND_TYPE.ASYNC) {\n    sendAsync(data);\n  }\n}\n\nexport function sendSync(data: ITrackerData) {\n  const config = getConfig();\n  clearTimeout(timer);\n  allData.push(_generateData(data, config));\n  _sendToServer(allData);\n  allData.length = 0;\n}\n\n/**\n * 延迟发送  data不存在则马上发送\n * @param data\n */\nexport function sendAsync(data?: ITrackerData) {\n  const config = getConfig();\n  if (data) {\n    allData.push(_generateData(data, config));\n  }\n  clearTimeout(timer);\n  // 无参数或者大于10条发送发送\n  if ((!data && allData.length > 0) || allData.length >= 10) {\n    _sendToServer(allData);\n    allData.length = 0;\n    return;\n  }\n  timer = setTimeout(() => {\n    _sendToServer(allData);\n    allData.length = 0;\n  }, config.delayTime);\n}\n\n/**\n * 发送到服务器\n * @param data\n * @param isAjax\n */\nfunction _sendToServer(data: ILogDataDataItem[], isAjax?: boolean) {\n  // console.log(JSON.stringify(data, null, 2));\n  return http(JSON.stringify(_wrapperData(data)), isAjax);\n}\n\n/**\n * 合并其他信息\n * @param data\n */\nfunction _wrapperData(data: ILogDataDataItem[]): ILogData {\n  //console.log(JSON.stringify(data, null, 2));\n  const config = getConfig();\n  index++;\n  return {\n    items: data,\n    ...clientInfo(),\n    ...libInfo,\n    ...getUserInfo(),\n    version: config.version\n  };\n}\n\n/**\n * 补充埋点信息\n * @param data\n * @param config\n */\nfunction _generateData(data: ITrackerData, config: IConfig): ILogDataDataItem {\n  index++;\n  //序列化自定义\n  if (isObject(data.custom)) {\n    const customStr = JSON.stringify(data.custom);\n    if (customStr.length <= 500) {\n      data.custom = JSON.stringify(data.custom);\n    }\n  }\n\n  const newData = pick(SAFETY_KEY, data);\n\n  const pageInfo = getPageInfo();\n\n  const netInfo = getNetInfo();\n\n  if (data.actionType === 'PAGE') {\n    pageInfo.pageId = null;\n  }\n\n  const result = {\n    ...newData,\n    ...pageInfo,\n    ...netInfo,\n    trackTime: Date.now(),\n    id: uuid + '-' + index\n  };\n\n  // console.log(JSON.stringify(result, null, 2));\n\n  return result;\n}\n","import { SERVER_URL } from '../constant/index';\nimport Base64 from './base64';\nimport { getConfig } from 'src/core/config';\n\nexport default function http(data: string, isAjax = false, isSendBeacon = true) {\n  const config = getConfig();\n  return new Promise((resolve) => {\n    //const dataStr=Base64.encode(JSON.stringify(data));\n    const dataStr = data;\n\n    const url = `${SERVER_URL}?${config.trackKey ? `trackKey=${config.trackKey}&` : ''}time=${Date.now()}`;\n\n    if (\n      window.location.protocol === 'https:' &&\n      isSendBeacon &&\n      typeof window.navigator.sendBeacon === 'function' &&\n      typeof Blob === 'function'\n    ) {\n      const headers = {\n        type: 'text/plain; charset=UTF-8'\n      };\n      const blob = new Blob([dataStr], headers);\n      const success = window.navigator.sendBeacon(url, blob);\n      if (success) {\n        resolve();\n        return;\n      }\n    }\n\n    if (isAjax) {\n      const xhr = new XMLHttpRequest();\n      xhr.withCredentials = true;\n      xhr.addEventListener('readystatechange', function () {\n        if (this.readyState === 4) {\n          resolve();\n        }\n      });\n      xhr.open('POST', url, true);\n      xhr.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8');\n      xhr.withCredentials = true;\n      xhr.send(dataStr);\n    } else {\n      const img: HTMLImageElement = new Image();\n      img.onload = () => {\n        resolve();\n      };\n      img.src = `${url}&data=${encodeURIComponent(dataStr)}`;\n    }\n  });\n}\n","export default function () {\n  return {\n    clientWidth: window.screen.height,\n    clientHeight: window.screen.width,\n    radio: window.devicePixelRatio || 1,\n    domain: document.domain || ''\n  };\n}\n","export default function () {\n  const connection =\n    (window as any).navigator.connection ||\n    (window as any).navigator.mozConnection ||\n    (window as any).navigator.webkitConnection ||\n    {};\n  const type = connection.type || connection.effectiveType;\n  if (!type) {\n    return {};\n  }\n  return {\n    netType: type\n  };\n}\n","import { getPageInfo } from './pageInfo';\nimport { ITrackerPageParam } from './actionTracker';\nimport { send } from './send';\nimport { ACTION_TYPE } from '../constant';\nimport { getConfig, IConfig } from './config';\nimport { ITrackerData } from '../types';\nimport { actionTracker } from 'src/internal';\nclass PageTimeTracker {\n  static instance: PageTimeTracker = null;\n  startTime = Date.now();\n  endTime = Date.now();\n  // invalidStartTime = Date.now();\n  // invalidEndTime = Date.now();\n  // totalInvalidTime = 0;\n  config: IConfig = null;\n  info: ITrackerData = null;\n\n  isStart = false;\n\n  backInfo: ITrackerData = null;\n\n  static getInstance() {\n    if (!PageTimeTracker.instance) {\n      PageTimeTracker.instance = new PageTimeTracker();\n    }\n    return PageTimeTracker.instance;\n  }\n\n  start(data?: ITrackerPageParam) {\n    if (data) {\n      this.info = data;\n    }\n    if (this.isStart) {\n      this.startTime = Date.now();\n      return;\n    }\n    this.isStart = true;\n    this.config = getConfig();\n    window.addEventListener('visibilitychange', () => {\n      var isHidden = document.hidden;\n      if (isHidden) {\n        this.backInfo = this.info;\n        this.end();\n      } else {\n        this.info = this.backInfo;\n        // todo 处理pageInfo\n        this.start();\n      }\n    });\n  }\n\n  end() {\n    if (!this.info) {\n      return;\n    }\n    this.endTime = Date.now();\n    this.toSend();\n  }\n\n  /**\n   * url change 触发\n   */\n  change() {\n    this.end();\n    this.start();\n  }\n\n  toSend() {\n    if (this.config.autoTrackPage || this.info) {\n      const durationTime = this.endTime - this.startTime;\n      if (durationTime < 100) {\n        // 手动发后100豪秒内不能自动change\n        return;\n      }\n      let data = {\n        startTime: this.startTime,\n        durationTime,\n        ...this.info,\n        actionType: ACTION_TYPE.DURATION,\n        trackId: ''\n      };\n\n      send(data);\n      this.info = null;\n    }\n  }\n}\n\nlet instance = PageTimeTracker.getInstance();\nexport default instance;\n","import vissense from 'vissense';\nimport { VisSenseConfig } from '../types';\nconst VisSense = vissense(window);\nconst VisSenseUtils = VisSense.Utils;\nconst createInnerMonitor = function(outerMonitor: any, callback: Function, config: VisSenseConfig) {\n  let timeElapsed = 0;\n  let timeStarted: any = null;\n  let timeLimit = config.timeLimit;\n  let percentageLimit = config.percentageLimit;\n  let interval = config.interval;\n\n  return VisSense.VisMon.Builder(outerMonitor.visobj())\n    .strategy(new VisSense.VisMon.Strategy.PollingStrategy({ interval: interval }))\n    .on('update', function(monitor: any) {\n      let percentage = monitor.state().percentage;\n      if (percentage < percentageLimit) {\n        timeStarted = null;\n      } else {\n        let now = VisSenseUtils.now();\n        timeStarted = timeStarted || now;\n        timeElapsed = now - timeStarted;\n      }\n\n      if (timeElapsed >= timeLimit) {\n        monitor.stop();\n        outerMonitor.stop();\n        callback(monitor);\n      }\n    })\n    .on('stop', function() {\n      timeStarted = null;\n    })\n    .build();\n};\n\nconst onPercentageTimeTestPassed = function(visobj: any, callback: Function, config: VisSenseConfig) {\n  const _config = VisSenseUtils.defaults(config, {\n    percentageLimit: 1,\n    timeLimit: 1000,\n    interval: 100,\n    strategy: undefined\n  });\n\n  // monitor is considered hidden if it is 1% below the percentage limit\n  let hiddenLimit = Math.max(_config.percentageLimit - 0.001, 0);\n\n  let innerMonitor: any = null;\n\n  let outerMonitor = VisSense.VisMon.Builder(\n    new VisSense(visobj.element(), {\n      hidden: hiddenLimit,\n      referenceWindow: visobj.referenceWindow()\n    })\n  )\n    .set('strategy', _config.strategy)\n    .on('visible', function(monitor: any) {\n      if (innerMonitor === null) {\n        innerMonitor = createInnerMonitor(monitor, callback, _config);\n      }\n      innerMonitor.start();\n    })\n    .on('hidden', function() {\n      if (innerMonitor !== null) {\n        innerMonitor.stop();\n      }\n    })\n    .on('stop', function() {\n      if (innerMonitor !== null) {\n        innerMonitor.stop();\n      }\n    })\n    .build();\n\n  outerMonitor.start();\n\n  return function() {\n    outerMonitor.stop();\n    innerMonitor = null;\n  };\n};\n\nVisSense.fn.onPercentageTimeTestPassed = function(callback: Function, config: VisSenseConfig) {\n  onPercentageTimeTestPassed(this, callback, config);\n};\n\nexport default VisSense;\n","/*! { \"name\": \"vissense\", \"version\": \"0.10.0\", \"homepage\": \"https://vissense.github.io/vissense\",\"copyright\": \"(c) 2016 tbk\" } */\n!function(root, name, factory) {\n    \"use strict\";\n    var withWindow = function(win) {\n        var product = factory(win, win.document);\n        return product.noConflict = function() {\n            return product;\n        }, product;\n    };\n    if (\"function\" == typeof define && define.amd) define([], function() {\n        return withWindow;\n    }); else if (\"object\" == typeof exports) module.exports = function(win) {\n        return withWindow(win);\n    }; else {\n        var _oldValue = root[name], _newValue = factory(root, root.document);\n        root[name] = _newValue, root[name].noConflict = function() {\n            return root[name] = _oldValue, _newValue;\n        };\n    }\n}(this, \"VisSense\", function(window, document, undefined) {\n    \"use strict\";\n    function async(callback, delay) {\n        return function() {\n            var args = arguments;\n            return defer(function() {\n                callback.apply(undefined, args);\n            }, delay || 0);\n        };\n    }\n    function debounce(callback, delay) {\n        var cancel = noop;\n        return function() {\n            var self = this, args = arguments;\n            cancel(), cancel = defer(function() {\n                callback.apply(self, args);\n            }, delay);\n        };\n    }\n    function defaults(dest, source) {\n        var sourceIsObject = isObject(source), destIsObject = isObject(dest);\n        return sourceIsObject || destIsObject ? sourceIsObject && destIsObject ? (forEach(Object.keys(source), function(property) {\n            dest[property] === undefined && (dest[property] = source[property]);\n        }), dest) : sourceIsObject ? source : dest : source;\n    }\n    function defer(callback, delay) {\n        var timer = setTimeout(function() {\n            callback();\n        }, delay || 0);\n        return function() {\n            clearTimeout(timer);\n        };\n    }\n    function fireIf(when, callback) {\n        return function() {\n            return (isFunction(when) ? when() : when) ? callback() : undefined;\n        };\n    }\n    function extend(dest, source, callback) {\n        for (var index = -1, props = Object.keys(source), length = props.length, ask = isFunction(callback); ++index < length; ) {\n            var key = props[index];\n            dest[key] = ask ? callback(dest[key], source[key], key, dest, source) : source[key];\n        }\n        return dest;\n    }\n    function forEach(array, callback, thisArg) {\n        for (var i = 0, n = array.length; n > i; i++) {\n            var result = callback.call(thisArg, array[i], i, array);\n            if (result !== undefined) return result;\n        }\n    }\n    function identity(value) {\n        return value;\n    }\n    function isDefined(value) {\n        return value !== undefined;\n    }\n    function isArray(value) {\n        return value && \"object\" == typeof value && \"number\" == typeof value.length && \"[object Array]\" === Object.prototype.toString.call(value) || !1;\n    }\n    function isElement(value) {\n        return value && 1 === value.nodeType || !1;\n    }\n    function isFunction(value) {\n        return \"function\" == typeof value || !1;\n    }\n    function isObject(value) {\n        var type = typeof value;\n        return \"function\" === type || value && \"object\" === type || !1;\n    }\n    function noop() {}\n    function now() {\n        return new Date().getTime();\n    }\n    function once(callback) {\n        var cache, called = !1;\n        return function() {\n            return called || (cache = callback.apply(undefined, arguments), called = !0), cache;\n        };\n    }\n    function throttle(callback, wait, thisArg) {\n        var cancel = noop, last = !1;\n        return function() {\n            var time = now(), args = arguments, func = function() {\n                last = time, callback.apply(thisArg, args);\n            };\n            last && last + wait > time ? (cancel(), cancel = defer(func, wait)) : (last = time, \n            defer(func, 0));\n        };\n    }\n    function viewport(referenceWindow) {\n        var win = referenceWindow || window;\n        return {\n            height: win.innerHeight,\n            width: win.innerWidth\n        };\n    }\n    function computedStyle(element, referenceWindow) {\n        return (referenceWindow || window).getComputedStyle(element, null);\n    }\n    function styleProperty(style, property) {\n        return style.getPropertyValue(property);\n    }\n    function isDisplayed(element, style) {\n        style || (style = computedStyle(element));\n        var display = styleProperty(style, \"display\");\n        if (\"none\" === display) return !1;\n        var parent = element.parentNode;\n        return isElement(parent) ? isDisplayed(parent) : !0;\n    }\n    function isVisibleByStyling(element, referenceWindow) {\n        if (element === (referenceWindow || window).document) return !0;\n        if (!element || !element.parentNode) return !1;\n        var style = computedStyle(element, referenceWindow), visibility = styleProperty(style, \"visibility\");\n        return \"hidden\" === visibility || \"collapse\" === visibility ? !1 : isDisplayed(element, style);\n    }\n    function isInViewport(rect, viewport) {\n        return !rect || rect.width <= 0 || rect.height <= 0 ? !1 : rect.bottom > 0 && rect.right > 0 && rect.top < viewport.height && rect.left < viewport.width;\n    }\n    function percentage(element, referenceWindow) {\n        var rect = element.getBoundingClientRect(), view = viewport(referenceWindow);\n        if (!isInViewport(rect, view) || !isVisibleByStyling(element)) return 0;\n        var vh = 0, vw = 0;\n        return rect.top >= 0 ? vh = Math.min(rect.height, view.height - rect.top) : rect.bottom > 0 && (vh = Math.min(view.height, rect.bottom)), \n        rect.left >= 0 ? vw = Math.min(rect.width, view.width - rect.left) : rect.right > 0 && (vw = Math.min(view.width, rect.right)), \n        vh * vw / (rect.height * rect.width);\n    }\n    function isPageVisible(referenceWindow) {\n        return !createVisibilityApi(referenceWindow || window).isHidden();\n    }\n    function VisSense(element, config) {\n        if (!(this instanceof VisSense)) return new VisSense(element, config);\n        if (!isElement(element)) throw new Error(\"not an element node\");\n        this._element = element, this._config = defaults(config, {\n            fullyvisible: 1,\n            hidden: 0,\n            referenceWindow: window,\n            percentageHook: percentage,\n            precision: 3,\n            visibilityHooks: []\n        });\n        var roundFactor = this._config.precision <= 0 ? 1 : Math.pow(10, this._config.precision || 3);\n        this._round = function(val) {\n            return Math.round(val * roundFactor) / roundFactor;\n        };\n        var visibilityApi = createVisibilityApi(this._config.referenceWindow);\n        this._config.visibilityHooks.push(function() {\n            return !visibilityApi.isHidden();\n        });\n    }\n    function nextState(visobj, currentState) {\n        var newState = visobj.state(), percentage = newState.percentage;\n        return currentState && percentage === currentState.percentage && currentState.percentage === currentState.previous.percentage ? currentState : newState.hidden ? VisSense.VisState.hidden(percentage, currentState) : newState.fullyvisible ? VisSense.VisState.fullyvisible(percentage, currentState) : VisSense.VisState.visible(percentage, currentState);\n    }\n    function VisMon(visobj, config) {\n        var _config = defaults(config, {\n            strategy: [ new VisMon.Strategy.PollingStrategy(), new VisMon.Strategy.EventStrategy() ],\n            async: !1\n        });\n        this._visobj = visobj, this._state = {}, this._started = !1;\n        var anyTopicName = \"*#\" + now();\n        this._pubsub = new PubSub({\n            async: _config.async,\n            anyTopicName: anyTopicName\n        }), this._events = [ anyTopicName, \"start\", \"stop\", \"update\", \"hidden\", \"visible\", \"fullyvisible\", \"percentagechange\", \"visibilitychange\" ], \n        this._strategy = new VisMon.Strategy.CompositeStrategy(_config.strategy), this._strategy.init(this), \n        this._pubsub.on(\"update\", function(monitor) {\n            var newValue = monitor._state.percentage, oldValue = monitor._state.previous.percentage;\n            newValue !== oldValue && monitor._pubsub.publish(\"percentagechange\", [ monitor, newValue, oldValue ]);\n        }), this._pubsub.on(\"update\", function(monitor) {\n            monitor._state.code !== monitor._state.previous.code && monitor._pubsub.publish(\"visibilitychange\", [ monitor ]);\n        }), this._pubsub.on(\"visibilitychange\", function(monitor) {\n            monitor._state.visible && !monitor._state.previous.visible && monitor._pubsub.publish(\"visible\", [ monitor ]);\n        }), this._pubsub.on(\"visibilitychange\", function(monitor) {\n            monitor._state.fullyvisible && monitor._pubsub.publish(\"fullyvisible\", [ monitor ]);\n        }), this._pubsub.on(\"visibilitychange\", function(monitor) {\n            monitor._state.hidden && monitor._pubsub.publish(\"hidden\", [ monitor ]);\n        }), forEach(this._events, function(event) {\n            isFunction(_config[event]) && this.on(event, _config[event]);\n        }, this);\n    }\n    var createVisibilityApi = function(referenceWindow) {\n        return function(document, undefined) {\n            var entry = function(propertyName, eventName) {\n                return {\n                    property: propertyName,\n                    event: eventName\n                };\n            }, event = \"visibilitychange\", dict = [ entry(\"webkitHidden\", \"webkit\" + event), entry(\"msHidden\", \"ms\" + event), entry(\"mozHidden\", \"moz\" + event), entry(\"hidden\", event) ], api = forEach(dict, function(entry) {\n                return document[entry.property] !== undefined ? {\n                    isHidden: function() {\n                        return !!document[entry.property] || !1;\n                    },\n                    onVisibilityChange: function(callback) {\n                        return document.addEventListener(entry.event, callback, !1), function() {\n                            document.removeEventListener(entry.event, callback, !1);\n                        };\n                    }\n                } : void 0;\n            });\n            return api || {\n                isHidden: function() {\n                    return !1;\n                },\n                onVisibilityChange: function() {\n                    return noop;\n                }\n            };\n        }((referenceWindow || window).document);\n    }, PubSub = function(undefined) {\n        function PubSub(config) {\n            this._cache = {}, this._onAnyCache = [], this._config = defaults(config, {\n                async: !1,\n                anyTopicName: \"*\"\n            });\n        }\n        var syncFireListeners = function(consumers, args) {\n            forEach(consumers, function(consumer) {\n                consumer(args);\n            });\n        };\n        return PubSub.prototype.on = function(topic, callback) {\n            if (!isFunction(callback)) return noop;\n            var applyCallback = function(args) {\n                return callback.apply(undefined, args || []);\n            }, listener = this._config.async ? async(applyCallback) : applyCallback, unregister = function(listener, array, topic) {\n                return function() {\n                    var index = array.indexOf(listener);\n                    return index > -1 ? (array.splice(index, 1), !0) : !1;\n                };\n            };\n            return topic === this._config.anyTopicName ? (this._onAnyCache.push(listener), unregister(listener, this._onAnyCache, \"*\")) : (this._cache[topic] || (this._cache[topic] = []), \n            this._cache[topic].push(listener), unregister(listener, this._cache[topic], topic));\n        }, PubSub.prototype.publish = function(topic, args) {\n            var listeners = (this._cache[topic] || []).concat(topic === this._config.anyTopicName ? [] : this._onAnyCache), enableAsync = !!this._config.async, syncOrAsyncPublish = enableAsync ? async(syncFireListeners) : function(listeners, args) {\n                return syncFireListeners(listeners, args), noop;\n            };\n            return syncOrAsyncPublish(listeners, args || []);\n        }, PubSub;\n    }();\n    VisSense.prototype.state = function() {\n        var hiddenByHook = forEach(this._config.visibilityHooks, function(hook) {\n            return hook(this._element) ? void 0 : VisSense.VisState.hidden(0);\n        }, this);\n        return hiddenByHook || function(visobj, element, config) {\n            var perc = visobj._round(config.percentageHook(element, config.referenceWindow));\n            return perc <= config.hidden ? VisSense.VisState.hidden(perc) : perc >= config.fullyvisible ? VisSense.VisState.fullyvisible(perc) : VisSense.VisState.visible(perc);\n        }(this, this._element, this._config);\n    }, VisSense.prototype.percentage = function() {\n        return this.state().percentage;\n    }, VisSense.prototype.element = function() {\n        return this._element;\n    }, VisSense.prototype.referenceWindow = function() {\n        return this._config.referenceWindow;\n    }, VisSense.prototype.isFullyVisible = function() {\n        return this.state().fullyvisible;\n    }, VisSense.prototype.isVisible = function() {\n        return this.state().visible;\n    }, VisSense.prototype.isHidden = function() {\n        return this.state().hidden;\n    }, VisSense.fn = VisSense.prototype, VisSense.of = function(element, config) {\n        return new VisSense(element, config);\n    };\n    var STATES = {\n        HIDDEN: [ 0, \"hidden\" ],\n        VISIBLE: [ 1, \"visible\" ],\n        FULLY_VISIBLE: [ 2, \"fullyvisible\" ]\n    };\n    return VisSense.VisState = function() {\n        function newVisState(state, percentage, previous) {\n            return previous && delete previous.previous, {\n                code: state[0],\n                state: state[1],\n                percentage: percentage,\n                previous: previous || {},\n                fullyvisible: state[0] === STATES.FULLY_VISIBLE[0],\n                visible: state[0] === STATES.VISIBLE[0] || state[0] === STATES.FULLY_VISIBLE[0],\n                hidden: state[0] === STATES.HIDDEN[0]\n            };\n        }\n        return {\n            hidden: function(percentage, previous) {\n                return newVisState(STATES.HIDDEN, percentage, previous);\n            },\n            visible: function(percentage, previous) {\n                return newVisState(STATES.VISIBLE, percentage, previous);\n            },\n            fullyvisible: function(percentage, previous) {\n                return newVisState(STATES.FULLY_VISIBLE, percentage, previous);\n            }\n        };\n    }(), VisMon.prototype.visobj = function() {\n        return this._visobj;\n    }, VisMon.prototype.publish = function(eventName, args) {\n        var isInternalEvent = this._events.indexOf(eventName) >= 0;\n        if (isInternalEvent) throw new Error('Cannot publish internal event \"' + eventName + '\" from external scope.');\n        return this._pubsub.publish(eventName, args);\n    }, VisMon.prototype.state = function() {\n        return this._state;\n    }, VisMon.prototype.start = function(config) {\n        if (this._started) return this;\n        var _config = defaults(config, {\n            async: !1\n        });\n        return this._cancelAsyncStart && this._cancelAsyncStart(), _config.async ? this.startAsync() : (this._started = !0, \n        this.update(), this._pubsub.publish(\"start\", [ this ]), this._strategy.start(this), \n        this);\n    }, VisMon.prototype.startAsync = function(config) {\n        this._cancelAsyncStart && this._cancelAsyncStart();\n        var me = this, cancelAsyncStart = defer(function() {\n            me.start(extend(defaults(config, {}), {\n                async: !1\n            }));\n        });\n        return this._cancelAsyncStart = function() {\n            cancelAsyncStart(), me._cancelAsyncStart = null;\n        }, this;\n    }, VisMon.prototype.stop = function() {\n        this._cancelAsyncStart && this._cancelAsyncStart(), this._started && (this._strategy.stop(this), \n        this._pubsub.publish(\"stop\", [ this ])), this._started = !1;\n    }, VisMon.prototype.update = function() {\n        this._started && (this._state = nextState(this._visobj, this._state), this._pubsub.publish(\"update\", [ this ]));\n    }, VisMon.prototype.on = function(topic, callback) {\n        return this._pubsub.on(topic, callback);\n    }, VisMon.Builder = function() {\n        var combineStrategies = function(config, strategies) {\n            var combinedStrategies = null, forceDisableStrategies = config.strategy === !1, enableStrategies = !forceDisableStrategies && (config.strategy || strategies.length > 0);\n            if (enableStrategies) {\n                var configStrategyIsDefined = !!config.strategy, configStrategyIsArray = isArray(config.strategy), configStrategyAsArray = configStrategyIsDefined ? configStrategyIsArray ? config.strategy : [ config.strategy ] : [];\n                combinedStrategies = configStrategyAsArray.concat(strategies);\n            } else combinedStrategies = forceDisableStrategies ? [] : config.strategy;\n            return combinedStrategies;\n        };\n        return function(visobj) {\n            var config = {}, strategies = [], events = [], productBuilt = !1, product = null;\n            return {\n                set: function(name, value) {\n                    return config[name] = value, this;\n                },\n                strategy: function(strategy) {\n                    return strategies.push(strategy), this;\n                },\n                on: function(event, handler) {\n                    return events.push([ event, handler ]), this;\n                },\n                build: function(consumer) {\n                    var manufacture = function() {\n                        var combinedStrategies = combineStrategies(config, strategies);\n                        config.strategy = combinedStrategies;\n                        var monitor = visobj.monitor(config);\n                        return forEach(events, function(event) {\n                            monitor.on(event[0], event[1]);\n                        }), productBuilt = !0, product = monitor;\n                    }, monitor = productBuilt ? product : manufacture();\n                    return isFunction(consumer) ? consumer(monitor) : monitor;\n                }\n            };\n        };\n    }(), VisMon.Strategy = function() {}, VisMon.Strategy.prototype.init = noop, VisMon.Strategy.prototype.start = noop, \n    VisMon.Strategy.prototype.stop = noop, VisMon.Strategy.CompositeStrategy = function(strategies) {\n        this._strategies = isArray(strategies) ? strategies : [ strategies ];\n    }, VisMon.Strategy.CompositeStrategy.prototype = Object.create(VisMon.Strategy.prototype), \n    VisMon.Strategy.CompositeStrategy.prototype.init = function(monitor) {\n        forEach(this._strategies, function(strategy) {\n            isFunction(strategy.init) && strategy.init(monitor);\n        });\n    }, VisMon.Strategy.CompositeStrategy.prototype.start = function(monitor) {\n        forEach(this._strategies, function(strategy) {\n            isFunction(strategy.start) && strategy.start(monitor);\n        });\n    }, VisMon.Strategy.CompositeStrategy.prototype.stop = function(monitor) {\n        forEach(this._strategies, function(strategy) {\n            isFunction(strategy.stop) && strategy.stop(monitor);\n        });\n    }, VisMon.Strategy.PollingStrategy = function(config) {\n        this._config = defaults(config, {\n            interval: 1e3\n        }), this._started = !1;\n    }, VisMon.Strategy.PollingStrategy.prototype = Object.create(VisMon.Strategy.prototype), \n    VisMon.Strategy.PollingStrategy.prototype.start = function(monitor) {\n        return this._started || (this._clearInterval = function(interval) {\n            var intervalId = setInterval(function() {\n                monitor.update();\n            }, interval);\n            return function() {\n                clearInterval(intervalId);\n            };\n        }(this._config.interval), this._started = !0), this._started;\n    }, VisMon.Strategy.PollingStrategy.prototype.stop = function() {\n        return this._started ? (this._clearInterval(), this._started = !1, !0) : !1;\n    }, VisMon.Strategy.EventStrategy = function(config) {\n        this._config = defaults(config, {\n            throttle: 50\n        }), this._config.debounce > 0 && (this._config.throttle = +this._config.debounce), \n        this._started = !1;\n    }, VisMon.Strategy.EventStrategy.prototype = Object.create(VisMon.Strategy.prototype), \n    VisMon.Strategy.EventStrategy.prototype.start = function(monitor) {\n        return this._started || (this._removeEventListeners = function(update) {\n            var referenceWindow = monitor.visobj().referenceWindow(), visibilityApi = createVisibilityApi(referenceWindow), removeOnVisibilityChangeEvent = visibilityApi.onVisibilityChange(update);\n            return referenceWindow.addEventListener(\"scroll\", update, !1), referenceWindow.addEventListener(\"resize\", update, !1), \n            referenceWindow.addEventListener(\"touchmove\", update, !1), function() {\n                referenceWindow.removeEventListener(\"touchmove\", update, !1), referenceWindow.removeEventListener(\"resize\", update, !1), \n                referenceWindow.removeEventListener(\"scroll\", update, !1), removeOnVisibilityChangeEvent();\n            };\n        }(throttle(function() {\n            monitor.update();\n        }, this._config.throttle)), this._started = !0), this._started;\n    }, VisMon.Strategy.EventStrategy.prototype.stop = function() {\n        return this._started ? (this._removeEventListeners(), this._started = !1, !0) : !1;\n    }, VisSense.VisMon = VisMon, VisSense.PubSub = PubSub, VisSense.fn.monitor = function(config) {\n        return new VisMon(this, config);\n    }, VisSense.Utils = {\n        async: async,\n        debounce: debounce,\n        defaults: defaults,\n        defer: defer,\n        extend: extend,\n        forEach: forEach,\n        fireIf: fireIf,\n        identity: identity,\n        isArray: isArray,\n        isDefined: isDefined,\n        isElement: isElement,\n        isFunction: isFunction,\n        isObject: isObject,\n        isPageVisible: isPageVisible,\n        isVisibleByStyling: isVisibleByStyling,\n        noop: noop,\n        now: now,\n        once: once,\n        throttle: throttle,\n        percentage: percentage,\n        VisibilityApi: createVisibilityApi(),\n        createVisibilityApi: createVisibilityApi,\n        _viewport: viewport,\n        _isInViewport: isInViewport,\n        _isDisplayed: isDisplayed,\n        _computedStyle: computedStyle,\n        _styleProperty: styleProperty\n    }, VisSense;\n});","import { setPageInfo, getPageInfo } from './pageInfo';\n\nimport { send } from './send';\nimport { ACTION_TYPE } from '../constant';\nimport { getDomPath } from '../utils/util';\nimport { ITrackerData, VisSenseConfig } from '../types';\nimport pageTimeTracker from './pageTimeTracker';\nimport { getConfig } from './config';\n\nimport VisSense from './viewTracker';\n\nexport type ITrackerParam = { actionType: string } & (ITrackerPageParam | ITrackerEventParam);\n\nexport interface ITrackerPageParam {\n  custom?: string | { [prop: string]: string | number | boolean };\n  trackId?: string;\n  score?: number;\n  channel?: string;\n}\n\nexport interface ITrackerViewParam {\n  custom?: string | { [prop: string]: string | number | boolean };\n  trackId?: string;\n  score?: number;\n  channel?: string;\n}\n\nexport interface ITrackerEventParam {\n  custom?: string | { [prop: string]: string | number | boolean };\n  eventName?: string;\n  pageId?: string;\n  trackId?: string;\n  score?: number;\n  channel?: string;\n}\n\nexport interface ITrackerDomParam {\n  trackId: string;\n  actionType: string;\n  eventName: string;\n  domId: string;\n  domClass: string;\n  domHref: string;\n  domName: string;\n  domTag: string;\n  domContent: string;\n  domPath: string;\n}\n\nexport interface ITrackerDurationParam {\n  custom?: string | { [prop: string]: string | number | boolean };\n  pageId?: string;\n  score?: number;\n  channel?: string;\n}\n\n/**\n *埋点入口类\n *\n * @class ActionTracker\n */\nclass ActionTracker {\n  static instance: ActionTracker = null;\n  static getInstance() {\n    if (!ActionTracker.instance) {\n      ActionTracker.instance = new ActionTracker();\n    }\n    return ActionTracker.instance;\n  }\n  /**\n   * 埋点页面,如果需要埋页面时间重置时间 发送放pageChange发\n   * @memberof ActionTracker\n   */\n  trackPage(info: ITrackerPageParam = {}) {\n    const config = getConfig();\n    if (config.pageTime) {\n      pageTimeTracker.end();\n    }\n\n    let data: ITrackerData = {\n      actionType: ACTION_TYPE.PAGE,\n      ...info\n    };\n\n    //修改当前pageInfo\n    const { pageId, url } = getPageInfo();\n    setPageInfo({ pageId: data.trackId || '', referrerId: pageId || '', referrerUrl: url || '' });\n    send(data);\n    if (config.pageTime) {\n      pageTimeTracker.start(data);\n    }\n  }\n\n  /**\n   * 时长埋点\n   * @memberof ActionTracker\n   */\n  trackDuration(info: ITrackerDurationParam = {}) {\n    let data: ITrackerData = {\n      actionType: ACTION_TYPE.DURATION,\n      ...info\n    };\n    send(data);\n  }\n\n  /**\n   *\n   *事件埋点\n   */\n  trackEvent(info: ITrackerEventParam = {}) {\n    let data: ITrackerData = {\n      actionType: ACTION_TYPE.EVENT,\n      eventName: 'CLICK',\n      ...info\n    };\n    send(data);\n  }\n\n  /**\n   * 视窗埋点 暂时不启用\n   * @param dom\n   * @param info\n   * @param visSenseConfig\n   */\n  trackView(dom: HTMLElement, info: ITrackerViewParam, visSenseConfig: VisSenseConfig = {}) {\n    let data: ITrackerData = {\n      actionType: ACTION_TYPE.VIEW,\n      domId: dom.id,\n      domClass: dom.className,\n      domTag: dom.tagName,\n      domContent: dom.textContent.substr(0, 20),\n      domPath: getDomPath(dom),\n      ...info\n    };\n\n    var visobj = VisSense(dom);\n    visobj.onPercentageTimeTestPassed(\n      function () {\n        send(data);\n      },\n      {\n        percentageLimit: visSenseConfig.percentageLimit || 0.5,\n        timeLimit: visSenseConfig.timeLimit || 1000,\n        interval: 200\n      }\n    );\n  }\n\n  /**\n   *通用埋点入口 埋点类型自行控制\n   *\n   */\n  track(info: ITrackerParam) {\n    switch (info.actionType) {\n      case ACTION_TYPE.EVENT:\n        this.trackEvent(info);\n        break;\n      case ACTION_TYPE.PAGE:\n        this.trackPage(info);\n        break;\n      default:\n        break;\n    }\n    send(info);\n  }\n\n  /**\n   * a标签埋点 做300毫秒延迟跳转 确保埋点成功\n   * @param linkDom\n   * @param info\n   */\n  trackLink(linkDom: HTMLLinkElement, info: ITrackerEventParam = {}) {\n    linkDom.addEventListener(\n      'click',\n      function (e) {\n        e.preventDefault();\n        setTimeout(() => {\n          linkDom.click();\n        }, 300);\n      },\n      false\n    );\n    this.trackDom(linkDom, info);\n  }\n\n  /**\n   *埋点dom 做1秒防抖\n   *\n   * @param {(HTMLLinkElement | HTMLInputElement | HTMLLinkElement)} dom\n   * @param {ITrackerData} [info={}]\n   * @returns\n   * @memberof ActionTracker\n   */\n  trackDom(dom: HTMLLinkElement | HTMLInputElement | HTMLLinkElement, info: ITrackerEventParam = {}) {\n    //防止频繁触发\n    const _dom: any = dom;\n    if (_dom.IS_TRACKED) {\n      clearTimeout(_dom.DELAY_TRACK_TIME);\n      _dom.DELAY_TRACK_TIME = setTimeout(() => {\n        _dom.IS_TRACKED = false;\n      }, 1000);\n      return;\n    }\n    _dom.IS_TRACKED = true;\n    _dom.DELAY_TRACK_TIME = setTimeout(() => {\n      _dom.IS_TRACKED = false;\n    }, 1000);\n\n    let trackInfo = {\n      trackId: '',\n      domId: dom.id,\n      domClass: dom.className,\n      domHref: (dom as HTMLLinkElement).href || '',\n      domName: (dom as HTMLInputElement).name || '',\n      domTag: dom.tagName,\n      domContent: dom.textContent.substr(0, 20),\n      domPath: getDomPath(dom)\n    };\n\n    let track = dom.getAttribute('data-track');\n\n    if (track && track.search(/^\\{[\\S\\s]*\\}$/) >= 0) {\n      trackInfo = { ...trackInfo, ...JSON.parse(track) };\n    } else {\n      trackInfo.trackId = track || '';\n    }\n    if (info) {\n      trackInfo = { ...trackInfo, ...info };\n    }\n    this.trackEvent(trackInfo);\n  }\n}\n\nlet instance = ActionTracker.getInstance();\n\nexport default instance;\n","/**\n * Determine if the passed argument is an integer.\n *\n * @private\n * @param {*} n\n * @category Type\n * @return {Boolean}\n */\nmodule.exports = Number.isInteger || function _isInteger(n) {\n  return n << 0 === n;\n};","function _isString(x) {\n  return Object.prototype.toString.call(x) === '[object String]';\n}\n\nmodule.exports = _isString;","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar _isString =\n/*#__PURE__*/\nrequire(\"./internal/_isString\");\n/**\n * Returns the nth element of the given list or string. If n is negative the\n * element at index length + n is returned.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig Number -> [a] -> a | Undefined\n * @sig Number -> String -> String\n * @param {Number} offset\n * @param {*} list\n * @return {*}\n * @example\n *\n *      const list = ['foo', 'bar', 'baz', 'quux'];\n *      R.nth(1, list); //=> 'bar'\n *      R.nth(-1, list); //=> 'quux'\n *      R.nth(-99, list); //=> undefined\n *\n *      R.nth(2, 'abc'); //=> 'c'\n *      R.nth(3, 'abc'); //=> ''\n * @symb R.nth(-1, [a, b, c]) = c\n * @symb R.nth(0, [a, b, c]) = a\n * @symb R.nth(1, [a, b, c]) = b\n */\n\n\nvar nth =\n/*#__PURE__*/\n_curry2(function nth(offset, list) {\n  var idx = offset < 0 ? list.length + offset : offset;\n  return _isString(list) ? list.charAt(idx) : list[idx];\n});\n\nmodule.exports = nth;","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar _isInteger =\n/*#__PURE__*/\nrequire(\"./internal/_isInteger\");\n\nvar nth =\n/*#__PURE__*/\nrequire(\"./nth\");\n/**\n * Retrieves the values at given paths of an object.\n *\n * @func\n * @memberOf R\n * @since v0.27.0\n * @category Object\n * @typedefn Idx = [String | Int]\n * @sig [Idx] -> {a} -> [a | Undefined]\n * @param {Array} pathsArray The array of paths to be fetched.\n * @param {Object} obj The object to retrieve the nested properties from.\n * @return {Array} A list consisting of values at paths specified by \"pathsArray\".\n * @see R.path\n * @example\n *\n *      R.paths([['a', 'b'], ['p', 0, 'q']], {a: {b: 2}, p: [{q: 3}]}); //=> [2, 3]\n *      R.paths([['a', 'b'], ['p', 'r']], {a: {b: 2}, p: [{q: 3}]}); //=> [2, undefined]\n */\n\n\nvar paths =\n/*#__PURE__*/\n_curry2(function paths(pathsArray, obj) {\n  return pathsArray.map(function (paths) {\n    var val = obj;\n    var idx = 0;\n    var p;\n\n    while (idx < paths.length) {\n      if (val == null) {\n        return;\n      }\n\n      p = paths[idx];\n      val = _isInteger(p) ? nth(p, val) : val[p];\n      idx += 1;\n    }\n\n    return val;\n  });\n});\n\nmodule.exports = paths;","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar paths =\n/*#__PURE__*/\nrequire(\"./paths\");\n/**\n * Retrieve the value at a given path.\n *\n * @func\n * @memberOf R\n * @since v0.2.0\n * @category Object\n * @typedefn Idx = String | Int\n * @sig [Idx] -> {a} -> a | Undefined\n * @param {Array} path The path to use.\n * @param {Object} obj The object to retrieve the nested property from.\n * @return {*} The data at `path`.\n * @see R.prop, R.nth\n * @example\n *\n *      R.path(['a', 'b'], {a: {b: 2}}); //=> 2\n *      R.path(['a', 'b'], {c: {b: 2}}); //=> undefined\n *      R.path(['a', 'b', 0], {a: {b: [1, 2, 3]}}); //=> 1\n *      R.path(['a', 'b', -2], {a: {b: [1, 2, 3]}}); //=> 2\n */\n\n\nvar path =\n/*#__PURE__*/\n_curry2(function path(pathAr, obj) {\n  return paths([pathAr], obj)[0];\n});\n\nmodule.exports = path;","var _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar path =\n/*#__PURE__*/\nrequire(\"./path\");\n/**\n * Returns a function that when supplied an object returns the indicated\n * property of that object, if it exists.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @typedefn Idx = String | Int\n * @sig Idx -> {s: a} -> a | Undefined\n * @param {String|Number} p The property name or array index\n * @param {Object} obj The object to query\n * @return {*} The value at `obj.p`.\n * @see R.path, R.nth\n * @example\n *\n *      R.prop('x', {x: 100}); //=> 100\n *      R.prop('x', {}); //=> undefined\n *      R.prop(0, [100]); //=> 100\n *      R.compose(R.inc, R.prop('x'))({ x: 3 }) //=> 4\n */\n\n\nvar prop =\n/*#__PURE__*/\n_curry2(function prop(p, obj) {\n  return path([p], obj);\n});\n\nmodule.exports = prop;","var _curry1 =\n/*#__PURE__*/\nrequire(\"./_curry1\");\n\nvar _curry2 =\n/*#__PURE__*/\nrequire(\"./_curry2\");\n\nvar _isPlaceholder =\n/*#__PURE__*/\nrequire(\"./_isPlaceholder\");\n/**\n * Optimized internal three-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\n\n\nfunction _curry3(fn) {\n  return function f3(a, b, c) {\n    switch (arguments.length) {\n      case 0:\n        return f3;\n\n      case 1:\n        return _isPlaceholder(a) ? f3 : _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        });\n\n      case 2:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f3 : _isPlaceholder(a) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _curry1(function (_c) {\n          return fn(a, b, _c);\n        });\n\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) && _isPlaceholder(c) ? f3 : _isPlaceholder(a) && _isPlaceholder(b) ? _curry2(function (_a, _b) {\n          return fn(_a, _b, c);\n        }) : _isPlaceholder(a) && _isPlaceholder(c) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) && _isPlaceholder(c) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b, c);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b, c);\n        }) : _isPlaceholder(c) ? _curry1(function (_c) {\n          return fn(a, b, _c);\n        }) : fn(a, b, c);\n    }\n  };\n}\n\nmodule.exports = _curry3;","var _curry1 =\n/*#__PURE__*/\nrequire(\"./internal/_curry1\");\n/**\n * Returns a function that always returns the given value. Note that for\n * non-primitives the value returned is a reference to the original value.\n *\n * This function is known as `const`, `constant`, or `K` (for K combinator) in\n * other languages and libraries.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig a -> (* -> a)\n * @param {*} val The value to wrap in a function\n * @return {Function} A Function :: * -> val.\n * @example\n *\n *      const t = R.always('Tee');\n *      t(); //=> 'Tee'\n */\n\n\nvar always =\n/*#__PURE__*/\n_curry1(function always(val) {\n  return function () {\n    return val;\n  };\n});\n\nmodule.exports = always;","var _curry3 =\n/*#__PURE__*/\nrequire(\"./internal/_curry3\"); // `Identity` is a functor that holds a single value, where `map` simply\n// transforms the held value with the provided function.\n\n\nvar Identity = function (x) {\n  return {\n    value: x,\n    map: function (f) {\n      return Identity(f(x));\n    }\n  };\n};\n/**\n * Returns the result of \"setting\" the portion of the given data structure\n * focused by the given lens to the result of applying the given function to\n * the focused value.\n *\n * @func\n * @memberOf R\n * @since v0.16.0\n * @category Object\n * @typedefn Lens s a = Functor f => (a -> f a) -> s -> f s\n * @sig Lens s a -> (a -> a) -> s -> s\n * @param {Lens} lens\n * @param {*} v\n * @param {*} x\n * @return {*}\n * @see R.prop, R.lensIndex, R.lensProp\n * @example\n *\n *      const headLens = R.lensIndex(0);\n *\n *      R.over(headLens, R.toUpper, ['foo', 'bar', 'baz']); //=> ['FOO', 'bar', 'baz']\n */\n\n\nvar over =\n/*#__PURE__*/\n_curry3(function over(lens, f, x) {\n  // The value returned by the getter function is first transformed with `f`,\n  // then set as the value of an `Identity`. This is then mapped over with the\n  // setter function of the lens.\n  return lens(function (y) {\n    return Identity(f(y));\n  })(x).value;\n});\n\nmodule.exports = over;","var _curry3 =\n/*#__PURE__*/\nrequire(\"./internal/_curry3\");\n\nvar always =\n/*#__PURE__*/\nrequire(\"./always\");\n\nvar over =\n/*#__PURE__*/\nrequire(\"./over\");\n/**\n * Returns the result of \"setting\" the portion of the given data structure\n * focused by the given lens to the given value.\n *\n * @func\n * @memberOf R\n * @since v0.16.0\n * @category Object\n * @typedefn Lens s a = Functor f => (a -> f a) -> s -> f s\n * @sig Lens s a -> a -> s -> s\n * @param {Lens} lens\n * @param {*} v\n * @param {*} x\n * @return {*}\n * @see R.prop, R.lensIndex, R.lensProp\n * @example\n *\n *      const xLens = R.lensProp('x');\n *\n *      R.set(xLens, 4, {x: 1, y: 2});  //=> {x: 4, y: 2}\n *      R.set(xLens, 8, {x: 1, y: 2});  //=> {x: 8, y: 2}\n */\n\n\nvar set =\n/*#__PURE__*/\n_curry3(function set(lens, v, x) {\n  return over(lens, always(v), x);\n});\n\nmodule.exports = set;","function _arity(n, fn) {\n  /* eslint-disable no-unused-vars */\n  switch (n) {\n    case 0:\n      return function () {\n        return fn.apply(this, arguments);\n      };\n\n    case 1:\n      return function (a0) {\n        return fn.apply(this, arguments);\n      };\n\n    case 2:\n      return function (a0, a1) {\n        return fn.apply(this, arguments);\n      };\n\n    case 3:\n      return function (a0, a1, a2) {\n        return fn.apply(this, arguments);\n      };\n\n    case 4:\n      return function (a0, a1, a2, a3) {\n        return fn.apply(this, arguments);\n      };\n\n    case 5:\n      return function (a0, a1, a2, a3, a4) {\n        return fn.apply(this, arguments);\n      };\n\n    case 6:\n      return function (a0, a1, a2, a3, a4, a5) {\n        return fn.apply(this, arguments);\n      };\n\n    case 7:\n      return function (a0, a1, a2, a3, a4, a5, a6) {\n        return fn.apply(this, arguments);\n      };\n\n    case 8:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        return fn.apply(this, arguments);\n      };\n\n    case 9:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        return fn.apply(this, arguments);\n      };\n\n    case 10:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n        return fn.apply(this, arguments);\n      };\n\n    default:\n      throw new Error('First argument to _arity must be a non-negative integer no greater than ten');\n  }\n}\n\nmodule.exports = _arity;","var _arity =\n/*#__PURE__*/\nrequire(\"./_arity\");\n\nvar _isPlaceholder =\n/*#__PURE__*/\nrequire(\"./_isPlaceholder\");\n/**\n * Internal curryN function.\n *\n * @private\n * @category Function\n * @param {Number} length The arity of the curried function.\n * @param {Array} received An array of arguments received thus far.\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\n\n\nfunction _curryN(length, received, fn) {\n  return function () {\n    var combined = [];\n    var argsIdx = 0;\n    var left = length;\n    var combinedIdx = 0;\n\n    while (combinedIdx < received.length || argsIdx < arguments.length) {\n      var result;\n\n      if (combinedIdx < received.length && (!_isPlaceholder(received[combinedIdx]) || argsIdx >= arguments.length)) {\n        result = received[combinedIdx];\n      } else {\n        result = arguments[argsIdx];\n        argsIdx += 1;\n      }\n\n      combined[combinedIdx] = result;\n\n      if (!_isPlaceholder(result)) {\n        left -= 1;\n      }\n\n      combinedIdx += 1;\n    }\n\n    return left <= 0 ? fn.apply(this, combined) : _arity(left, _curryN(length, combined, fn));\n  };\n}\n\nmodule.exports = _curryN;","var _arity =\n/*#__PURE__*/\nrequire(\"./internal/_arity\");\n\nvar _curry1 =\n/*#__PURE__*/\nrequire(\"./internal/_curry1\");\n\nvar _curry2 =\n/*#__PURE__*/\nrequire(\"./internal/_curry2\");\n\nvar _curryN =\n/*#__PURE__*/\nrequire(\"./internal/_curryN\");\n/**\n * Returns a curried equivalent of the provided function, with the specified\n * arity. The curried function has two unusual capabilities. First, its\n * arguments needn't be provided one at a time. If `g` is `R.curryN(3, f)`, the\n * following are equivalent:\n *\n *   - `g(1)(2)(3)`\n *   - `g(1)(2, 3)`\n *   - `g(1, 2)(3)`\n *   - `g(1, 2, 3)`\n *\n * Secondly, the special placeholder value [`R.__`](#__) may be used to specify\n * \"gaps\", allowing partial application of any combination of arguments,\n * regardless of their positions. If `g` is as above and `_` is [`R.__`](#__),\n * the following are equivalent:\n *\n *   - `g(1, 2, 3)`\n *   - `g(_, 2, 3)(1)`\n *   - `g(_, _, 3)(1)(2)`\n *   - `g(_, _, 3)(1, 2)`\n *   - `g(_, 2)(1)(3)`\n *   - `g(_, 2)(1, 3)`\n *   - `g(_, 2)(_, 3)(1)`\n *\n * @func\n * @memberOf R\n * @since v0.5.0\n * @category Function\n * @sig Number -> (* -> a) -> (* -> a)\n * @param {Number} length The arity for the returned function.\n * @param {Function} fn The function to curry.\n * @return {Function} A new, curried function.\n * @see R.curry\n * @example\n *\n *      const sumArgs = (...args) => R.sum(args);\n *\n *      const curriedAddFourNumbers = R.curryN(4, sumArgs);\n *      const f = curriedAddFourNumbers(1, 2);\n *      const g = f(3);\n *      g(4); //=> 10\n */\n\n\nvar curryN =\n/*#__PURE__*/\n_curry2(function curryN(length, fn) {\n  if (length === 1) {\n    return _curry1(fn);\n  }\n\n  return _arity(length, _curryN(length, [], fn));\n});\n\nmodule.exports = curryN;","import { ITrackerParam } from './../core/actionTracker';\nimport { isThenable } from '../utils/util';\n\nimport actionTracker, { ITrackerEventParam } from '../core/actionTracker';\nimport curryN from 'ramda/src/curryN';\n\nconst before = curryN(\n  2,\n  (trackFn: Function | string | Object, fn: Function) =>\n    function(...args: any) {\n      if (typeof trackFn === 'function') {\n        try {\n          let result = trackFn.apply(this, args);\n          if (typeof result === 'object') {\n            actionTracker.track(result);\n          }\n        } catch (e) {\n          console.error(e);\n        }\n      } else if (typeof trackFn === 'object') {\n        actionTracker.track(trackFn as ITrackerParam);\n      } else if (typeof trackFn === 'string') {\n        const data = {\n          trackId: trackFn\n        };\n        actionTracker.track(data as ITrackerParam);\n      }\n\n      return fn.apply(this, args);\n    }\n);\n\nconst after = curryN(\n  2,\n  (trackFn: Function | string | Object, fn: Function) =>\n    function(...args: any) {\n      const r: Promise<any> = fn.apply(this, args);\n\n      const evalF = () => {\n        if (typeof trackFn === 'function') {\n          try {\n            let result = trackFn.apply(this, args);\n            if (typeof result === 'object') {\n              actionTracker.track(result);\n            }\n          } catch (e) {\n            console.error(e);\n          }\n        } else if (typeof trackFn === 'object') {\n          actionTracker.track(trackFn as ITrackerParam);\n        } else if (typeof trackFn === 'string') {\n          const data = {\n            trackId: trackFn\n          };\n          actionTracker.track(data as ITrackerParam);\n        }\n      };\n\n      if (isThenable(r)) {\n        return r.then(rr => {\n          evalF();\n          return rr;\n        });\n      }\n\n      evalF();\n      return r;\n    }\n);\n\nexport { before, after };\n","import actionTracker from '../core/actionTracker';\nimport pageTimeTracker from '../core/pageTimeTracker';\nimport { notChanged, isEmpty } from '../utils/util';\n\nconst generate = function (type: string) {\n  let watch: any[] = [];\n\n  const track = {\n    bind(el: HTMLElement, binding: any, vnode: any) {\n      let index = watch.findIndex((element) => element === el);\n      let isWatched = index !== -1;\n      if (el.style.display === 'none') {\n        if (!isWatched) watch.push(el);\n        return;\n      } else {\n        if (isWatched) watch.splice(index, 1);\n      }\n\n      if (!isWatched && (notChanged(binding) || isEmpty(binding))) return;\n\n      let info: any = {};\n\n      if (typeof binding.value === 'object') {\n        info = binding.value;\n        //if (value.pageURL) args.push(value.pageURL)\n      } else if (typeof binding.value === 'string' && binding.value) {\n        info.trackId = binding.value;\n      }\n      if (type === 'PAGE') {\n        actionTracker.trackPage(info);\n      } else {\n        actionTracker.trackView(el, info);\n      }\n    },\n    unbind(el: HTMLElement, binding: any) {\n      let index = watch.findIndex((element) => element === el);\n      if (index !== -1) watch.splice(index, 1);\n      pageTimeTracker.end();\n    },\n    update(el: HTMLElement, binding: any, vnode: any) {}\n  };\n\n  track.update = track.bind;\n  return track;\n};\n\nexport default generate;\n","import generate from './generate';\n\nexport default generate('VIEW');\n","import actionTracker, { ITrackerEventParam } from '../core/actionTracker';\nimport { notChanged, isEmpty } from '../utils/util';\n\nexport default function(el: HTMLElement, binding: any) {\n  if (notChanged(binding) || isEmpty(binding)) {\n    return;\n  }\n\n  let info: ITrackerEventParam = {};\n  if (typeof binding.value === 'object' && binding.value) {\n    info = binding.value as ITrackerEventParam;\n  } else if (typeof binding.value === 'string') {\n    info.trackId = binding.value;\n  } else if (typeof binding.value === 'number') {\n    info.trackId = binding.value + '';\n  }\n  el._trackerInfo = info;\n  el._isWatchTrack = true; //去除自动点击埋点\n\n  let events = Object.keys(binding.modifiers).filter(modifier => {\n    return binding.modifiers[modifier];\n  });\n  if (!events.length) events.push('click');\n\n  events.forEach((event: string) => {\n    el.removeEventListener(event, handleEvent, false);\n    el.addEventListener(event, handleEvent, false);\n  });\n}\n\nfunction handleEvent(e: Event) {\n  this._trackerInfo.eventName = e.type.toUpperCase();\n  actionTracker.trackDom(this, this._trackerInfo as ITrackerEventParam);\n}\n","import generate from './generate';\n\nexport default generate('PAGE');\n","import { getPageInfo } from './pageInfo';\n\nimport actionTracker from './actionTracker';\nimport pageTimeTracker from './pageTimeTracker';\nimport { getConfig, setConfig, IConfig } from './config';\nimport { sendAsync } from './send';\nimport hijackHistoryEvent from '../utils/hijackHistoryEvent';\nimport { getFlag, setFlag } from '../utils/util';\n\nfunction routeChange() {\n  pageTimeTracker.change();\n}\n\nconst install = function (conf?: Partial<IConfig>) {\n  if (getFlag('install')) return;\n  setFlag('install');\n  if (conf) {\n    setConfig(conf);\n  }\n  const config = getConfig();\n\n  //注入history事件\n  hijackHistoryEvent();\n\n  //自动埋页面\n  if (config.autoTrackPage) {\n    actionTracker.trackPage();\n  }\n\n  // if (config.performance) {\n  //   actionTracker.trackPerformance();\n  // }\n\n  // 页面时间start\n  // if (config.pageTime && !pageTimeTracker.info.trackId) {\n  //   pageTimeTracker.start();\n  // }\n\n  // 单页面应用routerchange\n  if (config.watchHistoryAndHash) {\n    if (typeof window.onpopstate === 'undefined') {\n      window.addEventListener('hashchange', routeChange);\n    }\n    window.addEventListener('historyPushState', routeChange);\n    window.addEventListener('historyPopstate', routeChange);\n  }\n\n  // onbeforeunload 和 onunload 都触发发送\n\n  const onLeave = (() => {\n    let sended = false;\n    return () => {\n      if (sended) {\n        return;\n      }\n      if (config.pageTime) {\n        pageTimeTracker.end();\n      }\n      sendAsync();\n      sended = true;\n    };\n  })();\n\n  window.addEventListener('beforeunload', onLeave);\n  window.addEventListener('unload', onLeave);\n\n  //dom 属性埋点\n  type NewMouseEvent = MouseEvent & {\n    path: HTMLLinkElement[] & HTMLInputElement[];\n  };\n  document.addEventListener(\n    'click',\n    (e: NewMouseEvent) => {\n      const path = (e as NewMouseEvent).path;\n      const element = e.target as HTMLElement & HTMLLinkElement;\n\n      if (typeof e.path === 'undefined' || !e.isTrusted) {\n        return;\n      }\n\n      for (let target of e.path) {\n        if (target.tagName === 'BODY') {\n          break;\n        }\n\n        //是否有埋点属性\n        if (\n          target.getAttribute('data-track') ||\n          (config.autoTrackClick &&\n            (target.tagName === 'A' || target.tagName === 'BUTTON' || target.tagName === 'INPUT') &&\n            !target._isWatchTrack)\n        ) {\n          if (element.tagName === 'A' && element.href) {\n            //劫持a链接注入本页面的code\n            const { pageId } = getPageInfo();\n            if (typeof pageId === 'string') {\n              if (/\\?.*=/.test(element.href)) {\n                element.href = element.href.replace(/\\?/, `?referrer-id=${pageId}&`);\n              } else if (/\\?/.test(element.href) === false) {\n                element.href += `?referrer-id=${pageId}`;\n              } else {\n                element.href = element.href.replace(/\\?/, `?referrer-id=${pageId}`);\n              }\n            }\n\n            //延迟跳转 加大上报成功率\n            if (config.delayLink) {\n              e.preventDefault();\n              setTimeout(() => {\n                actionTracker.trackDom(target);\n                element.click();\n              }, config.delayLinkTime);\n            }\n          } else {\n            actionTracker.trackDom(target);\n          }\n        }\n      }\n    },\n    false\n  );\n};\n\n//自动install\nwindow.addEventListener('load', () => {\n  const config = getConfig();\n  if (config.autoInstall) {\n    install();\n  }\n});\n\nexport default install;\n","import { getLocationHref, setFlag, getFlag } from './util';\n\nexport default function() {\n  if (getFlag('historyInjected')) return;\n  function historyEventTrigger(event: string, data: any) {\n    const fetchEvent = new CustomEvent(event, { detail: data });\n    window.dispatchEvent(fetchEvent);\n  }\n\n  function spellUrl(oldURL: string, newURL: string) {\n    if (/:\\/\\//.test(newURL)) {\n      return newURL;\n    }\n    let host = oldURL.match(/^.*:\\/\\/[^/]+/)[0];\n    return host + (/^\\//.test(newURL) ? '' : '/') + newURL;\n  }\n\n  let globalData = {\n    url: getLocationHref()\n  };\n\n  const oldOnpopstate = window.onpopstate;\n  window.onpopstate = function() {\n    let data = {\n      newURL: window.location.href,\n      oldURL: globalData.url\n    };\n    globalData.url = window.location.href;\n    historyEventTrigger.apply(this, ['historyPopstate', data]);\n    if (oldOnpopstate) {\n      return oldOnpopstate.apply(this, arguments);\n    }\n  };\n\n  const oldPushState = window.history.pushState;\n  oldPushState &&\n    (window.history.pushState = function(state: any, title: string, url: string) {\n      let data = {\n        newURL: spellUrl(globalData.url, url),\n        oldURL: globalData.url\n      };\n      globalData = {\n        url: data.newURL\n      };\n      historyEventTrigger.apply(this, ['historyPushState', data]);\n      if (oldPushState) {\n        return oldPushState.apply(this, arguments);\n      }\n    });\n\n  setFlag('historyInjected', true);\n}\n","import tracker from './decoratiors/tracker';\nimport actionTracker from './core/actionTracker';\nimport timeTracker from './core/pageTimeTracker';\nimport { getConfig, setConfig } from './core/config';\nimport { sendAsync, send, sendSync } from './core/send';\nimport { after, before } from './decoratiors/tools';\nimport vTrackView from './directives/trackView';\nimport vTrackEvent from './directives/trackEvent';\nimport vTrackPage from './directives/trackPage';\nimport install from './core/bindEvent';\nimport { login, logout } from './core/user';\n\nconst trackDom = actionTracker.trackDom;\nconst trackPage = actionTracker.trackPage;\nconst trackEvent = actionTracker.trackEvent;\nconst trackView = actionTracker.trackView;\nconst trackLink = actionTracker.trackLink;\nconst track = actionTracker.track;\n\nexport {\n  //装饰器\n  before,\n  after,\n  tracker,\n  //指令\n  vTrackView,\n  vTrackEvent,\n  vTrackPage,\n  //\n  install,\n  //tracker\n  actionTracker,\n  timeTracker,\n  trackDom,\n  trackPage,\n  trackEvent,\n  trackView,\n  trackLink,\n  track,\n  //config\n  setConfig,\n  getConfig,\n  //send\n  sendAsync,\n  send,\n  sendSync,\n  //user\n  login,\n  logout\n};\n","if (typeof XMLHttpRequest === 'undefined') {\n  throw new Error('tracker requires ie10+');\n}\n\ntry {\n  process.env.NODE_ENV;\n} catch (e) {\n  const g: any = typeof window !== 'undefined' ? window : global;\n  if (typeof g.process === 'undefined') g.process = {};\n  g.process.env = {};\n}\n\nif (typeof _TrackerGlobalData === 'undefined') {\n  window._TrackerGlobalData = {};\n}\nimport './91jkys';\nexport * from './internal';\n","import actionTracker from '../core/actionTracker';\nimport prop from 'ramda/src/prop';\nimport set from 'ramda/src/set';\nconst track = (partical: any) => {\n  if (typeof partical === 'function') {\n    return (target: Function | Object | string, key: string, descriptor: PropertyDescriptor) => {\n      const value = function(...args: any) {\n        const fn = partical.call(this, descriptor.value, this);\n        if (typeof fn === 'function') {\n          //参数为高阶函数\n          return fn.apply(this, args);\n        } else {\n          //普通函数\n          if (typeof fn === 'object') {\n            const data = { ...fn };\n            actionTracker.trackEvent(data);\n          }\n          return descriptor.value.apply(this, arguments);\n        }\n      };\n      // if (descriptor.initializer) {\n      //   return propSet('initializer', function() {\n      //     const value = descriptor.initializer.apply(this);\n      //     return function (...args) {\n      //       return partical.call(this, value, this).apply(this, args);\n      //     }\n      //   }, descriptor);\n      // }\n      return set(prop('value', descriptor), value, descriptor);\n    };\n  } else if (typeof partical === 'object') {\n    return (target: any, key: string, descriptor: PropertyDescriptor) => {\n      var oldValue = descriptor.value;\n      descriptor.value = function() {\n        const data = {\n          ...partical\n        };\n        actionTracker.trackEvent(data);\n        return oldValue.apply(this, arguments);\n      };\n      return descriptor;\n    };\n  } else {\n    //参数为string 作为tarckId\n    return (target: any, key: string, descriptor: PropertyDescriptor) => {\n      var oldValue = descriptor.value;\n      descriptor.value = function() {\n        const data = {\n          trackId: partical\n        };\n        actionTracker.trackEvent(data);\n        return oldValue.apply(this, arguments);\n      };\n      return descriptor;\n    };\n  }\n};\n\nexport default track;\n"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","SERVER_URL","window","location","protocol","SEND_TYPE","ACTION_TYPE","SAFETY_KEY","config","store","trackKey","serverUrl","pageTime","watchHistoryAndHash","env","console","projectId","version","domain","sendType","delayTime","autoTrackPage","autoTrackClick","autoInstall","delayLink","delayLinkTime","useServerTime","corssSubdomain","utokenKey","scriptDom","document","querySelector","getAttribute","getConfig","setConfig","data","a","fn","f1","_isPlaceholder","f2","b","_curry1","_b","_a","iter","next","list","done","push","value","pred","x","idx","len","f","match","String","prop","obj","is","toString","_has","hasEnumBug","propertyIsEnumerable","nonEnumerableProps","hasArgsEnumBug","contains","item","keys","nIdx","ks","checkArgsLength","_isArguments","val","undefined","slice","_uniqContentEquals","aIterator","bIterator","stackA","stackB","_arrayFromIterator","eq","_equals","_includesWith","aItem","_objectIs","typeA","type","equals","constructor","_functionName","valueOf","name","message","source","global","ignoreCase","multiline","sticky","unicode","size","entries","concat","values","keysA","extendedStackA","extendedStackB","key","isThenable","then","setCookie","expires","path","hours","date","cookie","replace","Date","setTime","getTime","toUTCString","notChanged","binding","oldValue","isEmpty","setFlag","_TrackerGlobalData","_trackerFlag","getFlag","getDomPath","dom","id","tagName","toLowerCase","parentNode","unshift","join","pageInfo","pageId","referrerId","variable","query","href","vars","split","pair","getQueryVariable","referrerUrl","referrer","url","origin","host","pathname","hash","title","getPageInfo","libVersion","libType","userInfo","uid","isLogin","names","result","allData","timer","uuid","c","r","Math","random","index","send","sendSync","sendAsync","clearTimeout","_generateData","_sendToServer","setTimeout","isAjax","isSendBeacon","Promise","resolve","dataStr","now","navigator","sendBeacon","Blob","blob","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","open","setRequestHeader","img","Image","onload","src","encodeURIComponent","http","JSON","stringify","items","clientWidth","screen","height","clientHeight","width","radio","devicePixelRatio","clientInfo","libInfo","getUserInfo","_wrapperData","o","custom","newData","pick","netInfo","connection","mozConnection","webkitConnection","effectiveType","netType","getNetInfo","actionType","trackTime","instance","PageTimeTracker","info","isStart","startTime","hidden","_this","backInfo","end","start","endTime","toSend","durationTime","trackId","getInstance","VisSense","withWindow","win","product","async","callback","delay","args","defer","defaults","dest","sourceIsObject","isObject","destIsObject","forEach","property","extend","props","ask","isFunction","array","thisArg","isArray","isElement","nodeType","noop","throttle","wait","cancel","last","time","func","viewport","referenceWindow","innerHeight","innerWidth","computedStyle","element","getComputedStyle","styleProperty","style","getPropertyValue","isDisplayed","parent","isVisibleByStyling","visibility","isInViewport","rect","bottom","right","top","left","percentage","getBoundingClientRect","view","vh","vw","min","Error","_element","_config","fullyvisible","percentageHook","precision","visibilityHooks","roundFactor","pow","_round","round","visibilityApi","createVisibilityApi","isHidden","VisMon","visobj","strategy","Strategy","PollingStrategy","EventStrategy","_visobj","_state","_started","anyTopicName","_pubsub","PubSub","_events","_strategy","CompositeStrategy","init","on","monitor","newValue","previous","publish","code","visible","event","entry","propertyName","eventName","onVisibilityChange","removeEventListener","_cache","_onAnyCache","syncFireListeners","consumers","consumer","topic","applyCallback","listener","unregister","indexOf","splice","listeners","state","hook","VisState","perc","isFullyVisible","isVisible","of","STATES","newVisState","_cancelAsyncStart","startAsync","update","me","cancelAsyncStart","stop","currentState","newState","nextState","Builder","strategies","events","productBuilt","set","handler","build","combinedStrategies","forceDisableStrategies","configStrategyIsDefined","configStrategyIsArray","combineStrategies","manufacture","_strategies","create","interval","_clearInterval","intervalId","setInterval","clearInterval","debounce","_removeEventListeners","removeOnVisibilityChangeEvent","Utils","self","fireIf","when","identity","isDefined","isPageVisible","once","cache","called","VisibilityApi","_viewport","_isInViewport","_isDisplayed","_computedStyle","_styleProperty","factory","noConflict","module","vissense","VisSenseUtils","onPercentageTimeTestPassed","percentageLimit","timeLimit","hiddenLimit","max","innerMonitor","outerMonitor","timeElapsed","timeStarted","createInnerMonitor","ActionTracker","pageTimeTracker","aaa","setPageInfo","visSenseConfig","domId","domClass","className","domTag","domContent","textContent","substr","domPath","trackEvent","trackPage","linkDom","e","preventDefault","click","trackDom","_dom","IS_TRACKED","DELAY_TRACK_TIME","trackInfo","domHref","domName","track","search","parse","Number","isInteger","offset","_isString","charAt","pathsArray","map","paths","_isInteger","nth","pathAr","f3","_curry2","_c","Identity","lens","y","v","over","always","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","_curryN","received","combined","argsIdx","combinedIdx","_arity","before","curryN","trackFn","_i","actionTracker","error","after","evalF","rr","generate","watch","bind","el","vnode","findIndex","isWatched","display","trackView","unbind","handleEvent","_trackerInfo","toUpperCase","routeChange","change","install","conf","globalData","oldOnpopstate","onpopstate","newURL","oldURL","historyEventTrigger","oldPushState","history","pushState","spellUrl","fetchEvent","CustomEvent","detail","dispatchEvent","test","hijackHistoryEvent","sended","onLeave","target","isTrusted","_isWatchTrack","trackLink","utoken","localStorage","getItem","setUserInfo","moment","cookies","arr","unescape","getCookie","setItem","partical","descriptor","modifiers","filter","modifier"],"mappings":"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"}