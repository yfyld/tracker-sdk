{"code":"import * as tslib_1 from \"tslib\";\r\nimport { send } from './send';\r\nimport { ACTION_TYPE } from '../constant';\r\nimport { getConfig } from './config';\r\nvar PageTimeTracker = /** @class */ (function () {\r\n    function PageTimeTracker() {\r\n        this.startTime = Date.now();\r\n        this.endTime = Date.now();\r\n        this.invalidStartTime = Date.now();\r\n        this.invalidEndTime = Date.now();\r\n        this.totalInvalidTime = 0;\r\n        this.config = null;\r\n        this.info = {};\r\n    }\r\n    PageTimeTracker.getInstance = function () {\r\n        if (!PageTimeTracker.instance) {\r\n            PageTimeTracker.instance = new PageTimeTracker();\r\n        }\r\n        return PageTimeTracker.instance;\r\n    };\r\n    PageTimeTracker.prototype.start = function () {\r\n        var _this = this;\r\n        this.startTime = Date.now();\r\n        this.config = getConfig();\r\n        window.addEventListener('visibilitychange', function () {\r\n            var isHidden = document.hidden;\r\n            if (isHidden) {\r\n                _this.invalidStartTime = Date.now();\r\n            }\r\n            else {\r\n                _this.invalidEndTime = Date.now();\r\n                _this.totalInvalidTime += _this.invalidEndTime - _this.invalidStartTime;\r\n            }\r\n        });\r\n    };\r\n    PageTimeTracker.prototype.end = function () {\r\n        this.endTime = Date.now();\r\n        var data = tslib_1.__assign({ actionType: ACTION_TYPE.PAGE, startTime: this.startTime, endTime: this.endTime, durationTime: this.endTime - this.startTime - this.totalInvalidTime }, this.info);\r\n        if (this.config.autoTrakerPage) {\r\n            send(data);\r\n        }\r\n    };\r\n    PageTimeTracker.prototype.change = function () {\r\n        this.invalidEndTime = this.invalidStartTime = this.endTime = Date.now();\r\n        var data = tslib_1.__assign({ actionType: ACTION_TYPE.PAGE, startTime: this.startTime, endTime: this.endTime, trackId: this.info.trackId, durationTime: this.endTime - this.startTime - this.totalInvalidTime }, this.info);\r\n        if (this.config.autoTrakerPage || this.info.trackId) {\r\n            send(data);\r\n            this.info = {};\r\n        }\r\n        this.startTime = this.endTime;\r\n    };\r\n    PageTimeTracker.instance = null;\r\n    return PageTimeTracker;\r\n}());\r\nvar instance = PageTimeTracker.getInstance();\r\nexport default instance;\r\n//# sourceMappingURL=pageTimeTracker.js.map","map":"{\"version\":3,\"file\":\"pageTimeTracker.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/core/pageTimeTracker.ts\"],\"names\":[],\"mappings\":\"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\"}"}
