{"code":"import { getLocationHref, setFlag, getFlag } from './util';\r\nexport default function () {\r\n    if (getFlag('historyInjected'))\r\n        return;\r\n    function historyEventTrigger(event, data) {\r\n        var fetchEvent = new CustomEvent(event, { detail: data });\r\n        window.dispatchEvent(fetchEvent);\r\n    }\r\n    function spellUrl(oldURL, newURL) {\r\n        if (/:\\/\\//.test(newURL)) {\r\n            return newURL;\r\n        }\r\n        var host = oldURL.match(/^.*:\\/\\/[^/]+/)[0];\r\n        return host + (/^\\//.test(newURL) ? '' : '/') + newURL;\r\n    }\r\n    var globalData = {\r\n        url: getLocationHref()\r\n    };\r\n    var oldOnpopstate = window.onpopstate;\r\n    window.onpopstate = function () {\r\n        var data = {\r\n            newURL: window.location.href,\r\n            oldURL: globalData.url\r\n        };\r\n        globalData.url = window.location.href;\r\n        historyEventTrigger.apply(this, ['historyPopstate', data]);\r\n        if (oldOnpopstate) {\r\n            return oldOnpopstate.apply(this, arguments);\r\n        }\r\n    };\r\n    var oldPushState = window.history.pushState;\r\n    oldPushState &&\r\n        (window.history.pushState = function (state, title, url) {\r\n            var data = {\r\n                newURL: spellUrl(globalData.url, url),\r\n                oldURL: globalData.url\r\n            };\r\n            globalData = {\r\n                url: data.newURL\r\n            };\r\n            historyEventTrigger.apply(this, ['historyPushState', data]);\r\n            if (oldPushState) {\r\n                return oldPushState.apply(this, arguments);\r\n            }\r\n        });\r\n    setFlag('historyInjected', true);\r\n}\r\n//# sourceMappingURL=hijackHistoryEvent.js.map","map":"{\"version\":3,\"file\":\"hijackHistoryEvent.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/utils/hijackHistoryEvent.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,eAAe,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,QAAQ,CAAA;AAE1D,MAAM,CAAC,OAAO;IACZ,IAAI,OAAO,CAAC,iBAAiB,CAAC;QAAE,OAAM;IACtC,SAAS,mBAAmB,CAAC,KAAY,EAAE,IAAQ;QACjD,IAAM,UAAU,GAAG,IAAI,WAAW,CAAC,KAAK,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAA;QAC3D,MAAM,CAAC,aAAa,CAAC,UAAU,CAAC,CAAA;IAClC,CAAC;IAED,SAAS,QAAQ,CAAC,MAAa,EAAE,MAAa;QAC5C,IAAI,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;YACxB,OAAO,MAAM,CAAA;SACd;QACD,IAAI,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,CAAA;QAC3C,OAAO,IAAI,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAA;IACxD,CAAC;IAED,IAAI,UAAU,GAAG;QACf,GAAG,EAAE,eAAe,EAAE;KACvB,CAAA;IAED,IAAM,aAAa,GAAG,MAAM,CAAC,UAAU,CAAA;IACvC,MAAM,CAAC,UAAU,GAAG;QAClB,IAAI,IAAI,GAAG;YACT,MAAM,EAAE,MAAM,CAAC,QAAQ,CAAC,IAAI;YAC5B,MAAM,EAAE,UAAU,CAAC,GAAG;SACvB,CAAA;QACD,UAAU,CAAC,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAA;QACrC,mBAAmB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC,CAAA;QAC1D,IAAI,aAAa,EAAE;YACjB,OAAO,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;SAC5C;IACH,CAAC,CAAA;IAED,IAAM,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC,SAAS,CAAA;IAC7C,YAAY;QACV,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,GAAG,UAAS,KAAS,EAAE,KAAY,EAAE,GAAU;YACtE,IAAI,IAAI,GAAG;gBACT,MAAM,EAAE,QAAQ,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,CAAC;gBACrC,MAAM,EAAE,UAAU,CAAC,GAAG;aACvB,CAAA;YACD,UAAU,GAAG;gBACX,GAAG,EAAE,IAAI,CAAC,MAAM;aACjB,CAAA;YACD,mBAAmB,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC,CAAA;YAC3D,IAAI,YAAY,EAAE;gBAChB,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAA;aAC3C;QACH,CAAC,CAAC,CAAA;IAEJ,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAA;AAClC,CAAC\"}"}
