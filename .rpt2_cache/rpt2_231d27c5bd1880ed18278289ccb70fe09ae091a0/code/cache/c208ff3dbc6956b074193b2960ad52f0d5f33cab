{"code":"import { SERVER_URL } from '../constant/index';\r\nimport Base64 from './base64';\r\nexport default function http(data, isAjax, isSendBeacon) {\r\n    if (isAjax === void 0) { isAjax = false; }\r\n    if (isSendBeacon === void 0) { isSendBeacon = true; }\r\n    return new Promise(function (resolve) {\r\n        var dataStr = Base64.encode(JSON.stringify(data));\r\n        var url = SERVER_URL + \"?time=\" + Date.now();\r\n        if (isSendBeacon && typeof window.navigator.sendBeacon === 'function' && typeof Blob === 'function') {\r\n            var headers = {\r\n                type: \"text/plain; charset=UTF-8\"\r\n            };\r\n            var blob = new Blob([dataStr], headers);\r\n            var success = window.navigator.sendBeacon(url, blob);\r\n            if (success) {\r\n                resolve();\r\n                return;\r\n            }\r\n        }\r\n        if (isAjax || dataStr.length > 8000) {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.withCredentials = true;\r\n            xhr.addEventListener(\"readystatechange\", function () {\r\n                if (this.readyState === 4) {\r\n                    resolve();\r\n                }\r\n            });\r\n            xhr.open('POST', url, true);\r\n            xhr.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8');\r\n            xhr.withCredentials = true;\r\n            xhr.send(dataStr);\r\n        }\r\n        else {\r\n            var img = new Image();\r\n            img.onload = function () {\r\n                resolve();\r\n            };\r\n            img.src = url + \"&data=\" + dataStr;\r\n        }\r\n    });\r\n}\r\n//# sourceMappingURL=http.js.map","map":"{\"version\":3,\"file\":\"http.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/utils/http.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAC,UAAU,EAAC,MAAM,mBAAmB,CAAA;AAC5C,OAAO,MAAM,MAAM,UAAU,CAAA;AAG7B,MAAM,CAAC,OAAO,UAAU,IAAI,CAAC,IAAoB,EAAC,MAAY,EAAC,YAAiB;IAA9B,uBAAA,EAAA,cAAY;IAAC,6BAAA,EAAA,mBAAiB;IAC9E,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO;QACzB,IAAM,OAAO,GAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;QAClD,IAAM,GAAG,GAAI,UAAU,cAAS,IAAI,CAAC,GAAG,EAAI,CAAA;QAC5C,IAAG,YAAY,IAAE,OAAO,MAAM,CAAC,SAAS,CAAC,UAAU,KAAG,UAAU,IAAE,OAAO,IAAI,KAAG,UAAU,EAAE;YAE1F,IAAM,OAAO,GAAG;gBACd,IAAI,EAAE,2BAA2B;aAClC,CAAA;YACD,IAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC;YAC1C,IAAM,OAAO,GAAC,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;YACrD,IAAG,OAAO,EAAC;gBACT,OAAO,EAAE,CAAA;gBACT,OAAO;aACR;SACF;QAED,IAAG,MAAM,IAAE,OAAO,CAAC,MAAM,GAAC,IAAI,EAAC;YAC7B,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;YACjC,GAAG,CAAC,eAAe,GAAG,IAAI,CAAC;YAC3B,GAAG,CAAC,gBAAgB,CAAC,kBAAkB,EAAE;gBACvC,IAAI,IAAI,CAAC,UAAU,KAAK,CAAC,EAAE;oBACzB,OAAO,EAAE,CAAC;iBACX;YACH,CAAC,CAAC,CAAC;YACH,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;YAC5B,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,0BAA0B,CAAC,CAAC;YACjE,GAAG,CAAC,eAAe,GAAG,IAAI,CAAC;YAC3B,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACnB;aAAI;YACH,IAAM,GAAG,GAAkB,IAAI,KAAK,EAAE,CAAA;YACtC,GAAG,CAAC,MAAM,GAAC;gBACT,OAAO,EAAE,CAAC;YACZ,CAAC,CAAA;YACD,GAAG,CAAC,GAAG,GAAI,GAAG,cAAS,OAAS,CAAA;SACjC;IAEH,CAAC,CAAC,CAAA;AACJ,CAAC\"}"}
